<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quarry Dispatch Dashboard | Professional MIS</title>
    <style>
        :root {
            --header-yellow: linear-gradient(135deg, #fff2cc 0%, #ffe699 100%);
            --header-orange: linear-gradient(135deg, #f8b88b 0%, #f5a76c 100%);
            --header-green: linear-gradient(135deg, #d5e8d4 0%, #b8d9a5 100%);
            --header-light-green: linear-gradient(135deg, #e1f5e1 0%, #c8e6c9 100%);
            --total-light-green: #d9ead3;
            --total-dark-green: linear-gradient(135deg, #c9daf8 0%, #a4c2f4 100%);
            --material-percent-bg: #fff2cc;
            --border-color: #d9d9d9;
            --shadow: 0 4px 12px rgba(0,0,0,0.08);
            --shadow-hover: 0 8px 24px rgba(0,0,0,0.12);
            --font-primary: 'Segoe UI', Roboto, -apple-system, BlinkMacSystemFont, sans-serif;
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --success-color: #27ae60;
            --warning-color: #f39c12;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: var(--font-primary);
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            padding: 20px;
            color: var(--primary-color);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .dashboard-header {
            text-align: center;
            margin-bottom: 20px;
            padding: 25px;
            background: linear-gradient(135deg, var(--primary-color) 0%, #34495e 100%);
            color: white;
            border-radius: 12px;
            box-shadow: var(--shadow);
        }

        .dashboard-header h1 {
            font-size: 2.2rem;
            margin-bottom: 8px;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .dashboard-header .subtitle {
            font-size: 1rem;
            opacity: 0.9;
            font-weight: 300;
        }

        .date-badge {
            display: inline-block;
            background: rgba(255, 255, 255, 0.15);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-top: 12px;
            font-weight: 500;
        }

        .section {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .section:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-hover);
        }

        .section-header {
            padding: 18px 25px;
            font-weight: 700;
            font-size: 1.25rem;
            margin: 0;
            position: sticky;
            top: 0;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .section-header.yellow {
            background: var(--header-yellow);
            color: #b33a00;
            border-bottom: 3px solid #ffcc00;
        }

        .section-header.orange {
            background: var(--header-orange);
            color: #000;
            font-weight: 800;
            border-bottom: 3px solid #e67e22;
        }

        .section-header.green {
            background: var(--header-green);
            color: #1a5a1a;
            border-bottom: 3px solid #27ae60;
        }

        .section-header.light-green {
            background: var(--header-light-green);
            color: #1a5a1a;
            border-bottom: 3px solid #2ecc71;
        }

        .total-badge {
            background: rgba(0, 0, 0, 0.1);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .table-container {
            overflow-x: auto;
            position: relative;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1200px;
        }

        th {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            position: sticky;
            top: 56px;
            z-index: 9;
            font-weight: 700;
            border: 1px solid var(--border-color);
            color: var(--primary-color);
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.5px;
            padding: 14px 12px;
        }

        th, td {
            padding: 12px 14px;
            text-align: center;
            border: 1px solid var(--border-color);
            font-size: 0.95rem;
        }

        td.numeric {
            text-align: right;
            font-family: 'Segoe UI', 'Roboto Mono', 'Courier New', monospace;
            font-weight: 500;
            padding-right: 20px;
        }

        td.date {
            text-align: center;
            font-weight: 600;
            color: var(--primary-color);
            background: #f8f9fa;
        }

        td.highlight {
            background-color: #fffde7;
            font-weight: 600;
        }

        tr:hover td:not(.date) {
            background-color: #f8f9fa;
        }

        .total-row {
            background-color: var(--total-light-green);
            font-weight: 800;
            font-size: 1rem;
        }

        .grand-total-row {
            background: var(--total-dark-green);
            font-weight: 800;
            font-size: 1.05rem;
            color: var(--primary-color);
        }

        .material-percent-row {
            background-color: var(--material-percent-bg);
            font-weight: 700;
        }

        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
            padding: 20px;
            position: sticky;
            top: 0;
            background: rgba(245, 247, 250, 0.95);
            backdrop-filter: blur(10px);
            z-index: 100;
            margin: -20px -20px 25px -20px;
            border-bottom: 1px solid rgba(0,0,0,0.1);
            flex-wrap: wrap;
        }

        .control-group {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .nav-buttons {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin: 30px 0 20px;
            flex-wrap: wrap;
        }

        button {
            padding: 12px 24px;
            background: linear-gradient(135deg, var(--secondary-color) 0%, #2980b9 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.3);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        button.print-btn {
            background: linear-gradient(135deg, var(--success-color) 0%, #219653 100%);
            box-shadow: 0 2px 8px rgba(39, 174, 96, 0.3);
        }

        button.print-btn:hover {
            box-shadow: 0 4px 12px rgba(39, 174, 96, 0.4);
        }

        button.nav-btn {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
            padding: 10px 20px;
            font-size: 0.9rem;
        }

        button.nav-btn:hover {
            background: linear-gradient(135deg, #7f8c8d 0%, #95a5a6 100%);
        }

        .scroll-indicator {
            text-align: center;
            color: #7f8c8d;
            font-size: 0.9rem;
            margin-top: 15px;
            font-style: italic;
            padding: 10px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .customer-name {
            text-align: left;
            font-weight: 600;
            color: var(--primary-color);
        }

        .ftd-box {
            background: linear-gradient(135deg, #fff8e1 0%, #fff3cd 100%);
            border: 2px solid #ffcc00;
            border-radius: 10px;
            padding: 20px;
            margin: 20px;
            box-shadow: 0 4px 12px rgba(255, 204, 0, 0.2);
        }

        .ftd-box h3 {
            color: #e67e22;
            margin-bottom: 15px;
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            border-left: 4px solid var(--secondary-color);
        }

        .stat-card .label {
            font-size: 0.9rem;
            color: #7f8c8d;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-card .value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            font-family: 'Roboto Mono', monospace;
        }

        .stat-card .subvalue {
            font-size: 1rem;
            color: var(--success-color);
            margin-top: 5px;
            font-weight: 600;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .controls, .nav-buttons, .scroll-indicator, .dashboard-header {
                display: none;
            }
            
            .section {
                box-shadow: none;
                border: 1px solid #000;
                break-inside: avoid;
                margin: 20px 0;
            }
            
            .table-container {
                overflow: visible;
            }
            
            table {
                min-width: auto;
            }
            
            .section:hover {
                transform: none;
            }
        }

        @media (max-width: 1200px) {
            .container {
                padding: 10px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .dashboard-header h1 {
                font-size: 1.8rem;
            }
            
            .section-header {
                padding: 15px 20px;
                font-size: 1.1rem;
                flex-direction: column;
                gap: 10px;
                align-items: flex-start;
            }
            
            th, td {
                padding: 10px 12px;
                font-size: 0.9rem;
            }
            
            .controls {
                flex-direction: column;
                gap: 15px;
            }
            
            .control-group {
                width: 100%;
                justify-content: center;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            button {
                padding: 10px 18px;
                font-size: 0.9rem;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="controls">
        <div class="control-group">
            <button onclick="scrollToTop()" title="Scroll to top">
                <i class="fas fa-arrow-up"></i> Top
            </button>
            <button onclick="toggleDarkMode()" title="Toggle dark mode">
                <i class="fas fa-moon"></i> Theme
            </button>
        </div>
        
        <div class="control-group">
            <button onclick="printPage()" class="print-btn">
                <i class="fas fa-print"></i> Print Report
            </button>
            <button onclick="exportToExcel()" title="Export to Excel">
                <i class="fas fa-file-excel"></i> Export
            </button>
        </div>
    </div>

    <div class="dashboard-header">
        <h1><i class="fas fa-mountain"></i> Quarry Dispatch Dashboard</h1>
        <div class="subtitle">Professional Management Information System for Dispatch Operations</div>
        <div class="date-badge">
            <i class="fas fa-calendar-alt"></i> Report Date: 19-Dec-2025
        </div>
    </div>

    <div class="container">
        <!-- Report 1: A-Shift Dispatched Details -->
        <div class="section" id="report1">
            <div class="section-header yellow">
                <span><i class="fas fa-sun"></i> A-Shift Dispatched Details</span>
                <span class="total-badge">Total: 45.67</span>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>10 MM</th>
                            <th>20 MM</th>
                            <th>V/SAND</th>
                            <th>P/SAND</th>
                            <th>Scalping</th>
                            <th>GSB / Wet Mix</th>
                            <th>40 MM</th>
                            <th>50 MM</th>
                            <th>R/Sand</th>
                            <th>TOTAL</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="date">19-Dec-2025</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric highlight">45.67</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric highlight">45.67</td>
                        </tr>
                        <tr class="total-row">
                            <td class="customer-name">Total</td>
                            <td class="numeric" id="a-10mm">0.00</td>
                            <td class="numeric" id="a-20mm">0.00</td>
                            <td class="numeric" id="a-vsand">0.00</td>
                            <td class="numeric" id="a-psand">45.67</td>
                            <td class="numeric" id="a-scalping">0.00</td>
                            <td class="numeric" id="a-gsb">0.00</td>
                            <td class="numeric" id="a-40mm">0.00</td>
                            <td class="numeric" id="a-50mm">0.00</td>
                            <td class="numeric" id="a-rsand">0.00</td>
                            <td class="numeric" id="a-total">45.67</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Report 2: B-Shift Dispatched Details -->
        <div class="section" id="report2">
            <div class="section-header yellow">
                <span><i class="fas fa-moon"></i> B-Shift Dispatched Details</span>
                <span class="total-badge">Total: 120.45</span>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>10 MM</th>
                            <th>20 MM</th>
                            <th>V/SAND</th>
                            <th>P/SAND</th>
                            <th>Scalping</th>
                            <th>GSB / Wet Mix</th>
                            <th>40 MM</th>
                            <th>50 MM</th>
                            <th>R/Sand</th>
                            <th>TOTAL</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="date">19-Dec-2025</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric highlight">120.45</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric highlight">120.45</td>
                        </tr>
                        <tr class="total-row">
                            <td class="customer-name">Total</td>
                            <td class="numeric" id="b-10mm">0.00</td>
                            <td class="numeric" id="b-20mm">0.00</td>
                            <td class="numeric" id="b-vsand">0.00</td>
                            <td class="numeric" id="b-psand">120.45</td>
                            <td class="numeric" id="b-scalping">0.00</td>
                            <td class="numeric" id="b-gsb">0.00</td>
                            <td class="numeric" id="b-40mm">0.00</td>
                            <td class="numeric" id="b-50mm">0.00</td>
                            <td class="numeric" id="b-rsand">0.00</td>
                            <td class="numeric" id="b-total">120.45</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- FTD Summary Box -->
        <div class="section" id="report3">
            <div class="section-header orange">
                <span><i class="fas fa-chart-line"></i> FTD Dispatched Summary (A Shift + B Shift)</span>
                <span class="total-badge">FTD Total: 166.12</span>
            </div>
            
            <div class="ftd-box">
                <h3><i class="fas fa-calculator"></i> Full Day Total Calculation</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="label">A-Shift Total</div>
                        <div class="value">45.67</div>
                        <div class="subvalue">Morning Shift</div>
                    </div>
                    <div class="stat-card">
                        <div class="label">B-Shift Total</div>
                        <div class="value">120.45</div>
                        <div class="subvalue">Evening Shift</div>
                    </div>
                    <div class="stat-card" style="border-left-color: #e74c3c;">
                        <div class="label">FTD Total</div>
                        <div class="value" style="color: #e74c3c;">166.12</div>
                        <div class="subvalue" style="color: #e74c3c;">45.67 + 120.45</div>
                    </div>
                    <div class="stat-card" style="border-left-color: #9b59b6;">
                        <div class="label">P/SAND Contribution</div>
                        <div class="value" style="color: #9b59b6;">100%</div>
                        <div class="subvalue">Primary Material</div>
                    </div>
                </div>
            </div>
            
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Shift</th>
                            <th>10 MM</th>
                            <th>20 MM</th>
                            <th>V/SAND</th>
                            <th>P/SAND</th>
                            <th>Scalping</th>
                            <th>GSB / Wet Mix</th>
                            <th>40 MM</th>
                            <th>50 MM</th>
                            <th>R/Sand</th>
                            <th>TOTAL</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="customer-name"><i class="fas fa-sun"></i> A Shift</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">45.67</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">45.67</td>
                        </tr>
                        <tr>
                            <td class="customer-name"><i class="fas fa-moon"></i> B Shift</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">120.45</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">120.45</td>
                        </tr>
                        <tr class="grand-total-row">
                            <td class="customer-name"><i class="fas fa-chart-bar"></i> FTD Total</td>
                            <td class="numeric" id="ftd-10mm">0.00</td>
                            <td class="numeric" id="ftd-20mm">0.00</td>
                            <td class="numeric" id="ftd-vsand">0.00</td>
                            <td class="numeric" id="ftd-psand">166.12</td>
                            <td class="numeric" id="ftd-scalping">0.00</td>
                            <td class="numeric" id="ftd-gsb">0.00</td>
                            <td class="numeric" id="ftd-40mm">0.00</td>
                            <td class="numeric" id="ftd-50mm">0.00</td>
                            <td class="numeric" id="ftd-rsand">0.00</td>
                            <td class="numeric" id="ftd-total">166.12</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Report 4: Daily Dispatched Details -->
        <div class="section" id="report4">
            <div class="section-header green">
                <span><i class="fas fa-calendar-day"></i> Dispatched Details (Date-wise)</span>
                <span class="total-badge">Total: 16512.15</span>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>10 MM</th>
                            <th>20 MM</th>
                            <th>V/SAND</th>
                            <th>Scalping</th>
                            <th>P/Sand</th>
                            <th>40 MM</th>
                            <th>50 MM</th>
                            <th>GSB/WET MIX</th>
                            <th>R/Sand</th>
                            <th>TOTAL</th>
                        </tr>
                    </thead>
                    <tbody id="daily-data">
                        <!-- Data will be populated by JavaScript -->
                    </tbody>
                    <tfoot>
                        <tr class="grand-total-row">
                            <td class="customer-name">Total</td>
                            <td class="numeric" id="daily-10mm">0.00</td>
                            <td class="numeric" id="daily-20mm">0.00</td>
                            <td class="numeric" id="daily-vsand">0.00</td>
                            <td class="numeric" id="daily-scalping">0.00</td>
                            <td class="numeric" id="daily-psand">16512.15</td>
                            <td class="numeric" id="daily-40mm">0.00</td>
                            <td class="numeric" id="daily-50mm">0.00</td>
                            <td class="numeric" id="daily-gsb">0.00</td>
                            <td class="numeric" id="daily-rsand">0.00</td>
                            <td class="numeric" id="daily-total">16512.15</td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>

        <!-- Report 5: Customer-wise Cumulative Dispatch -->
        <div class="section" id="report5">
            <div class="section-header light-green">
                <span><i class="fas fa-users"></i> DECEMBER-2025 â€“ Customer Wise Cumulative Dispatched Details</span>
                <span class="total-badge">Total Customers: 5</span>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Customer Name</th>
                            <th>10 MM</th>
                            <th>20 MM</th>
                            <th>V/SAND</th>
                            <th>Scalping</th>
                            <th>P/Sand</th>
                            <th>40 MM</th>
                            <th>50 MM</th>
                            <th>GSB/WET MIX</th>
                            <th>R/Sand</th>
                            <th>TOTAL</th>
                            <th>Customer-wise Dispatch Participation (%)</th>
                        </tr>
                    </thead>
                    <tbody id="customer-data">
                        <!-- Data will be populated by JavaScript -->
                    </tbody>
                    <tfoot>
                        <tr class="total-row">
                            <td class="customer-name">Total</td>
                            <td class="numeric" id="cust-10mm">0.00</td>
                            <td class="numeric" id="cust-20mm">0.00</td>
                            <td class="numeric" id="cust-vsand">0.00</td>
                            <td class="numeric" id="cust-scalping">0.00</td>
                            <td class="numeric" id="cust-psand">16512.15</td>
                            <td class="numeric" id="cust-40mm">0.00</td>
                            <td class="numeric" id="cust-50mm">0.00</td>
                            <td class="numeric" id="cust-gsb">0.00</td>
                            <td class="numeric" id="cust-rsand">0.00</td>
                            <td class="numeric" id="cust-total">16512.15</td>
                            <td class="numeric">100.00%</td>
                        </tr>
                        <tr class="material-percent-row">
                            <td class="customer-name"><i class="fas fa-chart-pie"></i> Material Wise (%) Participation</td>
                            <td class="numeric" id="mat-10mm">0.00%</td>
                            <td class="numeric" id="mat-20mm">0.00%</td>
                            <td class="numeric" id="mat-vsand">0.00%</td>
                            <td class="numeric" id="mat-scalping">0.00%</td>
                            <td class="numeric" id="mat-psand">100.00%</td>
                            <td class="numeric" id="mat-40mm">0.00%</td>
                            <td class="numeric" id="mat-50mm">0.00%</td>
                            <td class="numeric" id="mat-gsb">0.00%</td>
                            <td class="numeric" id="mat-rsand">0.00%</td>
                            <td class="numeric" id="mat-total">100.00%</td>
                            <td class="numeric">-</td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </div>

    <div class="nav-buttons">
        <button onclick="scrollToReport(1)" class="nav-btn">
            <i class="fas fa-sun"></i> A-Shift
        </button>
        <button onclick="scrollToReport(2)" class="nav-btn">
            <i class="fas fa-moon"></i> B-Shift
        </button>
        <button onclick="scrollToReport(3)" class="nav-btn">
            <i class="fas fa-chart-line"></i> FTD Summary
        </button>
        <button onclick="scrollToReport(4)" class="nav-btn">
            <i class="fas fa-calendar-day"></i> Daily Details
        </button>
        <button onclick="scrollToReport(5)" class="nav-btn">
            <i class="fas fa-users"></i> Customer-wise
        </button>
    </div>

    <div class="scroll-indicator">
        <i class="fas fa-arrows-alt-h"></i> Scroll horizontally to view full table on mobile devices
    </div>

    <script>
        // Initialize data and calculations
        document.addEventListener('DOMContentLoaded', function() {
            initializeDailyData();
            initializeCustomerData();
            calculateAllTotals();
            updateFTDSummary();
            updateStats();
        });

        // Updated daily data for December 1-19, 2025 with new totals
        function initializeDailyData() {
            const dailyData = [
                { date: '01-Dec-2025', mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 920.5, mm40: 0, mm50: 0, gsb: 0, rsand: 0 },
                { date: '02-Dec-2025', mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 895.3, mm40: 0, mm50: 0, gsb: 0, rsand: 0 },
                { date: '03-Dec-2025', mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 1015.7, mm40: 0, mm50: 0, gsb: 0, rsand: 0 },
                { date: '04-Dec-2025', mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 885.6, mm40: 0, mm50: 0, gsb: 0, rsand: 0 },
                { date: '05-Dec-2025', mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 1008.4, mm40: 0, mm50: 0, gsb: 0, rsand: 0 },
                { date: '06-Dec-2025', mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 998.9, mm40: 0, mm50: 0, gsb: 0, rsand: 0 },
                { date: '07-Dec-2025', mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 1128.5, mm40: 0, mm50: 0, gsb: 0, rsand: 0 },
                { date: '08-Dec-2025', mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 875.2, mm40: 0, mm50: 0, gsb: 0, rsand: 0 },
                { date: '09-Dec-2025', mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 1005.8, mm40: 0, mm50: 0, gsb: 0, rsand: 0 },
                { date: '10-Dec-2025', mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 1012.4, mm40: 0, mm50: 0, gsb: 0, rsand: 0 },
                { date: '11-Dec-2025', mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 890.7, mm40: 0, mm50: 0, gsb: 0, rsand: 0 },
                { date: '12-Dec-2025', mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 1022.8, mm40: 0, mm50: 0, gsb: 0, rsand: 0 },
                { date: '13-Dec-2025', mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 897.6, mm40: 0, mm50: 0, gsb: 0, rsand: 0 },
                { date: '14-Dec-2025', mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 906.9, mm40: 0, mm50: 0, gsb: 0, rsand: 0 },
                { date: '15-Dec-2025', mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 882.3, mm40: 0, mm50: 0, gsb: 0, rsand: 0 },
                { date: '16-Dec-2025', mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 918.7, mm40: 0, mm50: 0, gsb: 0, rsand: 0 },
                { date: '17-Dec-2025', mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 901.5, mm40: 0, mm50: 0, gsb: 0, rsand: 0 },
                { date: '18-Dec-2025', mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 92.8, mm40: 0, mm50: 0, gsb: 0, rsand: 0 },
                { date: '19-Dec-2025', mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 166.12, mm40: 0, mm50: 0, gsb: 0, rsand: 0 }
            ];

            const tbody = document.getElementById('daily-data');
            dailyData.forEach(day => {
                const total = day.mm10 + day.mm20 + day.vsand + day.scalping + day.psand + 
                             day.mm40 + day.mm50 + day.gsb + day.rsand;
                
                const isToday = day.date === '19-Dec-2025';
                const rowClass = isToday ? 'highlight' : '';
                
                const row = `
                    <tr>
                        <td class="date ${rowClass}">${day.date}${isToday ? ' <i class="fas fa-star" style="color: #e67e22;"></i>' : ''}</td>
                        <td class="numeric ${rowClass}">${day.mm10.toFixed(2)}</td>
                        <td class="numeric ${rowClass}">${day.mm20.toFixed(2)}</td>
                        <td class="numeric ${rowClass}">${day.vsand.toFixed(2)}</td>
                        <td class="numeric ${rowClass}">${day.scalping.toFixed(2)}</td>
                        <td class="numeric ${rowClass}">${day.psand.toFixed(2)}</td>
                        <td class="numeric ${rowClass}">${day.mm40.toFixed(2)}</td>
                        <td class="numeric ${rowClass}">${day.mm50.toFixed(2)}</td>
                        <td class="numeric ${rowClass}">${day.gsb.toFixed(2)}</td>
                        <td class="numeric ${rowClass}">${day.rsand.toFixed(2)}</td>
                        <td class="numeric ${rowClass}">${total.toFixed(2)}</td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        // Sample customer data updated with P/SAND only
        function initializeCustomerData() {
            const customerData = [
                { name: 'Construction Corp A', mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 4500.2, mm40: 0, mm50: 0, gsb: 0, rsand: 0 },
                { name: 'Infra Builders Ltd', mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 3800.5, mm40: 0, mm50: 0, gsb: 0, rsand: 0 },
                { name: 'Mega Projects Inc', mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 5100.7, mm40: 0, mm50: 0, gsb: 0, rsand: 0 },
                { name: 'Roadways Const. Co.', mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 2950.3, mm40: 0, mm50: 0, gsb: 0, rsand: 0 },
                { name: 'Urban Developers', mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 4200.8, mm40: 0, mm50: 0, gsb: 0, rsand: 0 }
            ];

            const tbody = document.getElementById('customer-data');
            customerData.forEach(cust => {
                const total = cust.mm10 + cust.mm20 + cust.vsand + cust.scalping + cust.psand + 
                             cust.mm40 + cust.mm50 + cust.gsb + cust.rsand;
                
                const row = `
                    <tr>
                        <td class="customer-name"><i class="fas fa-building"></i> ${cust.name}</td>
                        <td class="numeric">${cust.mm10.toFixed(2)}</td>
                        <td class="numeric">${cust.mm20.toFixed(2)}</td>
                        <td class="numeric">${cust.vsand.toFixed(2)}</td>
                        <td class="numeric">${cust.scalping.toFixed(2)}</td>
                        <td class="numeric">${cust.psand.toFixed(2)}</td>
                        <td class="numeric">${cust.mm40.toFixed(2)}</td>
                        <td class="numeric">${cust.mm50.toFixed(2)}</td>
                        <td class="numeric">${cust.gsb.toFixed(2)}</td>
                        <td class="numeric">${cust.rsand.toFixed(2)}</td>
                        <td class="numeric">${total.toFixed(2)}</td>
                        <td class="numeric">${((total / 16512.15) * 100).toFixed(2)}%</td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        // Calculate all totals
        function calculateAllTotals() {
            // Daily totals
            const dailyRows = document.querySelectorAll('#daily-data tr');
            const dailyTotals = {
                mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 0,
                mm40: 0, mm50: 0, gsb: 0, rsand: 0, total: 0
            };

            dailyRows.forEach(row => {
                const cells = row.querySelectorAll('td.numeric');
                dailyTotals.mm10 += parseFloat(cells[0].textContent) || 0;
                dailyTotals.mm20 += parseFloat(cells[1].textContent) || 0;
                dailyTotals.vsand += parseFloat(cells[2].textContent) || 0;
                dailyTotals.scalping += parseFloat(cells[3].textContent) || 0;
                dailyTotals.psand += parseFloat(cells[4].textContent) || 0;
                dailyTotals.mm40 += parseFloat(cells[5].textContent) || 0;
                dailyTotals.mm50 += parseFloat(cells[6].textContent) || 0;
                dailyTotals.gsb += parseFloat(cells[7].textContent) || 0;
                dailyTotals.rsand += parseFloat(cells[8].textContent) || 0;
            });

            dailyTotals.total = dailyTotals.mm10 + dailyTotals.mm20 + dailyTotals.vsand + 
                               dailyTotals.scalping + dailyTotals.psand + dailyTotals.mm40 + 
                               dailyTotals.mm50 + dailyTotals.gsb + dailyTotals.rsand;

            // Update daily totals display
            document.getElementById('daily-10mm').textContent = dailyTotals.mm10.toFixed(2);
            document.getElementById('daily-20mm').textContent = dailyTotals.mm20.toFixed(2);
            document.getElementById('daily-vsand').textContent = dailyTotals.vsand.toFixed(2);
            document.getElementById('daily-scalping').textContent = dailyTotals.scalping.toFixed(2);
            document.getElementById('daily-psand').textContent = dailyTotals.psand.toFixed(2);
            document.getElementById('daily-40mm').textContent = dailyTotals.mm40.toFixed(2);
            document.getElementById('daily-50mm').textContent = dailyTotals.mm50.toFixed(2);
            document.getElementById('daily-gsb').textContent = dailyTotals.gsb.toFixed(2);
            document.getElementById('daily-rsand').textContent = dailyTotals.rsand.toFixed(2);
            document.getElementById('daily-total').textContent = dailyTotals.total.toFixed(2);

            // Customer totals
            const customerRows = document.querySelectorAll('#customer-data tr');
            const custTotals = {
                mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 0,
                mm40: 0, mm50: 0, gsb: 0, rsand: 0, total: 0
            };

            customerRows.forEach(row => {
                const cells = row.querySelectorAll('td.numeric');
                for(let i = 0; i < 9; i++) {
                    const value = parseFloat(cells[i].textContent) || 0;
                    switch(i) {
                        case 0: custTotals.mm10 += value; break;
                        case 1: custTotals.mm20 += value; break;
                        case 2: custTotals.vsand += value; break;
                        case 3: custTotals.scalping += value; break;
                        case 4: custTotals.psand += value; break;
                        case 5: custTotals.mm40 += value; break;
                        case 6: custTotals.mm50 += value; break;
                        case 7: custTotals.gsb += value; break;
                        case 8: custTotals.rsand += value; break;
                    }
                }
            });

            custTotals.total = custTotals.mm10 + custTotals.mm20 + custTotals.vsand + 
                              custTotals.scalping + custTotals.psand + custTotals.mm40 + 
                              custTotals.mm50 + custTotals.gsb + custTotals.rsand;

            // Update customer totals
            document.getElementById('cust-10mm').textContent = custTotals.mm10.toFixed(2);
            document.getElementById('cust-20mm').textContent = custTotals.mm20.toFixed(2);
            document.getElementById('cust-vsand').textContent = custTotals.vsand.toFixed(2);
            document.getElementById('cust-scalping').textContent = custTotals.scalping.toFixed(2);
            document.getElementById('cust-psand').textContent = custTotals.psand.toFixed(2);
            document.getElementById('cust-40mm').textContent = custTotals.mm40.toFixed(2);
            document.getElementById('cust-50mm').textContent = custTotals.mm50.toFixed(2);
            document.getElementById('cust-gsb').textContent = custTotals.gsb.toFixed(2);
            document.getElementById('cust-rsand').textContent = custTotals.rsand.toFixed(2);
            document.getElementById('cust-total').textContent = custTotals.total.toFixed(2);

            // Update material-wise percentages
            const grandTotal = custTotals.total || 1;
            document.getElementById('mat-10mm').textContent = ((custTotals.mm10 / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-20mm').textContent = ((custTotals.mm20 / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-vsand').textContent = ((custTotals.vsand / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-scalping').textContent = ((custTotals.scalping / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-psand').textContent = ((custTotals.psand / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-40mm').textContent = ((custTotals.mm40 / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-50mm').textContent = ((custTotals.mm50 / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-gsb').textContent = ((custTotals.gsb / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-rsand').textContent = ((custTotals.rsand / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-total').textContent = '100.00%';
        }

        // Update FTD Summary with new data
        function updateFTDSummary() {
            const aShift = {
                mm10: 0, mm20: 0, vsand: 0, psand: 45.67, scalping: 0,
                gsb: 0, mm40: 0, mm50: 0, rsand: 0, total: 45.67
            };
            
            const bShift = {
                mm10: 0, mm20: 0, vsand: 0, psand: 120.45, scalping: 0,
                gsb: 0, mm40: 0, mm50: 0, rsand: 0, total: 120.45
            };

            // Calculate FTD totals
            document.getElementById('ftd-10mm').textContent = (aShift.mm10 + bShift.mm10).toFixed(2);
            document.getElementById('ftd-20mm').textContent = (aShift.mm20 + bShift.mm20).toFixed(2);
            document.getElementById('ftd-vsand').textContent = (aShift.vsand + bShift.vsand).toFixed(2);
            document.getElementById('ftd-psand').textContent = (aShift.psand + bShift.psand).toFixed(2);
            document.getElementById('ftd-scalping').textContent = (aShift.scalping + bShift.scalping).toFixed(2);
            document.getElementById('ftd-gsb').textContent = (aShift.gsb + bShift.gsb).toFixed(2);
            document.getElementById('ftd-40mm').textContent = (aShift.mm40 + bShift.mm40).toFixed(2);
            document.getElementById('ftd-50mm').textContent = (aShift.mm50 + bShift.mm50).toFixed(2);
            document.getElementById('ftd-rsand').textContent = (aShift.rsand + bShift.rsand).toFixed(2);
            document.getElementById('ftd-total').textContent = (aShift.total + bShift.total).toFixed(2);
        }

        // Update statistics
        function updateStats() {
            // Additional stats can be added here
            console.log("Dashboard stats updated");
        }

        // Navigation functions
        function scrollToReport(reportNumber) {
            const report = document.getElementById(`report${reportNumber}`);
            if (report) {
                report.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function printPage() {
            window.print();
        }

        function exportToExcel() {
            alert('Excel export functionality would be implemented here with a backend connection.');
            // In a real implementation, this would generate an Excel file
        }

        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            alert('Dark mode toggle would change theme colors in a full implementation.');
        }
    </script>
</body>
</html>
