<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quarry Dispatch Dashboard | Professional MIS</title>
    <style>
        :root {
            --header-yellow: linear-gradient(135deg, #fff2cc 0%, #ffe699 100%);
            --header-orange: linear-gradient(135deg, #f8b88b 0%, #f5a76c 100%);
            --header-green: linear-gradient(135deg, #d5e8d4 0%, #b8d9a5 100%);
            --header-light-green: linear-gradient(135deg, #e1f5e1 0%, #c8e6c9 100%);
            --header-vehicle-planning: linear-gradient(135deg, #f2f2f2 0%, #e6e6e6 100%);
            --total-light-green: #d9ead3;
            --total-light-yellow: #fff2cc;
            --total-dark-green: linear-gradient(135deg, #c9daf8 0%, #a4c2f4 100%);
            --material-percent-bg: #fff2cc;
            --border-color: #d9d9d9;
            --shadow: 0 4px 12px rgba(0,0,0,0.08);
            --shadow-hover: 0 8px 24px rgba(0,0,0,0.12);
            --font-primary: 'Segoe UI', Roboto, -apple-system, BlinkMacSystemFont, sans-serif;
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: var(--font-primary);
        }
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            padding: 20px;
            color: var(--primary-color);
            line-height: 1.6;
            min-height: 100vh;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        .dashboard-header {
            text-align: center;
            margin-bottom: 20px;
            padding: 25px;
            background: linear-gradient(135deg, var(--primary-color) 0%, #34495e 100%);
            color: white;
            border-radius: 12px;
            box-shadow: var(--shadow);
        }
        .dashboard-header h1 {
            font-size: 2.2rem;
            margin-bottom: 8px;
            font-weight: 700;
            letter-spacing: 0.5px;
        }
        .dashboard-header .subtitle {
            font-size: 1rem;
            opacity: 0.9;
            font-weight: 300;
        }
        .date-badge {
            display: inline-block;
            background: rgba(255, 255, 255, 0.15);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-top: 12px;
            font-weight: 500;
        }
        .section {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .section:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-hover);
        }
        .section-header {
            padding: 18px 25px;
            font-weight: 700;
            font-size: 1.25rem;
            margin: 0;
            position: sticky;
            top: 0;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .section-header.yellow {
            background: var(--header-yellow);
            color: #b33a00;
            border-bottom: 3px solid #ffcc00;
        }
        .section-header.orange {
            background: var(--header-orange);
            color: #000;
            font-weight: 800;
            border-bottom: 3px solid #e67e22;
        }
        .section-header.green {
            background: var(--header-green);
            color: #1a5a1a;
            border-bottom: 3px solid #27ae60;
        }
        .section-header.light-green {
            background: var(--header-light-green);
            color: #1a5a1a;
            border-bottom: 3px solid #2ecc71;
        }
        .section-header.vehicle-planning {
            background: var(--header-vehicle-planning);
            color: #000;
            font-weight: 800;
            border-bottom: 3px solid #666;
            text-align: center;
            justify-content: center;
        }
        .total-badge {
            background: rgba(0, 0, 0, 0.1);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }
        .table-container {
            overflow-x: auto;
            position: relative;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1200px;
        }
        th {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            position: sticky;
            top: 56px;
            z-index: 9;
            font-weight: 700;
            border: 1px solid var(--border-color);
            color: var(--primary-color);
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.5px;
            padding: 14px 12px;
        }
        .vehicle-planning-table th {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            font-weight: 700;
        }
        th, td {
            padding: 12px 14px;
            text-align: center;
            border: 1px solid var(--border-color);
            font-size: 0.95rem;
        }
        td.numeric {
            text-align: right;
            font-family: 'Segoe UI', 'Roboto Mono', 'Courier New', monospace;
            font-weight: 500;
            padding-right: 20px;
        }
        td.date {
            text-align: center;
            font-weight: 600;
            color: var(--primary-color);
            background: #f8f9fa;
        }
        td.highlight {
            background-color: #fffde7;
            font-weight: 600;
        }
        .client-name-cell {
            background-color: #f3e5f5;
            font-weight: 600;
            text-align: left !important;
            padding-left: 20px !important;
        }
        tr:hover td:not(.date):not(.client-name-cell) {
            background-color: #f8f9fa;
        }
        .total-row {
            background-color: var(--total-light-green);
            font-weight: 800;
            font-size: 1rem;
        }
        .grand-total-row {
            background: var(--total-dark-green);
            font-weight: 800;
            font-size: 1.05rem;
            color: var(--primary-color);
        }
        .trips-total-row {
            background-color: var(--total-light-yellow);
            font-weight: 800;
            font-size: 1rem;
        }
        .material-percent-row {
            background-color: var(--material-percent-bg);
            font-weight: 700;
        }
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
            padding: 20px;
            position: sticky;
            top: 0;
            background: rgba(245, 247, 250, 0.95);
            backdrop-filter: blur(10px);
            z-index: 100;
            margin: -20px -20px 25px -20px;
            border-bottom: 1px solid rgba(0,0,0,0.1);
            flex-wrap: wrap;
        }
        .control-group {
            display: flex;
            gap: 12px;
            align-items: center;
        }
        .nav-buttons {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin: 30px 0 20px;
            flex-wrap: wrap;
        }
        button {
            padding: 12px 24px;
            background: linear-gradient(135deg, var(--secondary-color) 0%, #2980b9 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.3);
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.4);
        }
        button:active {
            transform: translateY(0);
        }
        button.print-btn {
            background: linear-gradient(135deg, var(--success-color) 0%, #219653 100%);
            box-shadow: 0 2px 8px rgba(39, 174, 96, 0.3);
        }
        button.print-btn:hover {
            box-shadow: 0 4px 12px rgba(39, 174, 96, 0.4);
        }
        button.nav-btn {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
            padding: 10px 20px;
            font-size: 0.9rem;
        }
        button.nav-btn:hover {
            background: linear-gradient(135deg, #7f8c8d 0%, #95a5a6 100%);
        }
        .scroll-indicator {
            text-align: center;
            color: #7f8c8d;
            font-size: 0.9rem;
            margin-top: 15px;
            font-style: italic;
            padding: 10px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .customer-name {
            text-align: left;
            font-weight: 600;
            color: var(--primary-color);
        }
        .ftd-box {
            background: linear-gradient(135deg, #fff8e1 0%, #fff3cd 100%);
            border: 2px solid #ffcc00;
            border-radius: 10px;
            padding: 20px;
            margin: 20px;
            box-shadow: 0 4px 12px rgba(255, 204, 0, 0.2);
        }
        .ftd-box h3 {
            color: #e67e22;
            margin-bottom: 15px;
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            border-left: 4px solid var(--secondary-color);
        }
        .stat-card .label {
            font-size: 0.9rem;
            color: #7f8c8d;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .stat-card .value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            font-family: 'Roboto Mono', monospace;
        }
        .stat-card .subvalue {
            font-size: 1rem;
            color: var(--success-color);
            margin-top: 5px;
            font-weight: 600;
        }
        .empty-cell {
            color: #999;
            font-style: italic;
        }
        .shift-combined-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        /* Full Row Action Buttons */
        .full-row-actions {
            display: flex;
            gap: 10px;
            margin: 20px 25px;
            flex-wrap: wrap;
        }
        
        .action-btn {
            padding: 10px 20px;
            border-radius: 6px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }
        
        .action-btn.add-row {
            background: linear-gradient(135deg, var(--success-color) 0%, #219653 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(39, 174, 96, 0.3);
        }
        
        .action-btn.add-row:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(39, 174, 96, 0.4);
        }
        
        .action-btn.edit-row {
            background: linear-gradient(135deg, var(--warning-color) 0%, #e67e22 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(243, 156, 18, 0.3);
        }
        
        .action-btn.edit-row:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(243, 156, 18, 0.4);
        }
        
        .action-btn.delete-row {
            background: linear-gradient(135deg, var(--danger-color) 0%, #c0392b 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(231, 76, 60, 0.3);
        }
        
        .action-btn.delete-row:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(231, 76, 60, 0.4);
        }
        
        .action-btn.refresh {
            background: linear-gradient(135deg, var(--secondary-color) 0%, #2980b9 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.3);
        }
        
        .action-btn.refresh:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.4);
        }
        
        .action-btn.export {
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(155, 89, 182, 0.3);
        }
        
        .action-btn.export:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(155, 89, 182, 0.4);
        }
        
        /* Row Actions in Table */
        .row-actions {
            display: flex;
            gap: 5px;
            justify-content: center;
        }
        
        .row-action-btn {
            width: 30px;
            height: 30px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }
        
        .row-action-btn.edit {
            background: var(--warning-color);
            color: white;
        }
        
        .row-action-btn.delete {
            background: var(--danger-color);
            color: white;
        }
        
        .row-action-btn:hover {
            transform: scale(1.1);
        }
        
        /* Form Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-hover);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-color);
        }
        
        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #999;
        }
        
        .close-modal:hover {
            color: var(--danger-color);
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .form-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 1rem;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }
        
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }
        
        @media (max-width: 768px) {
            .shift-combined-container {
                grid-template-columns: 1fr;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .full-row-actions {
                justify-content: center;
            }
        }
        
        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .controls, .nav-buttons, .scroll-indicator, .dashboard-header,
            .full-row-actions, .row-actions {
                display: none;
            }
            
            .section {
                box-shadow: none;
                border: 1px solid #000;
                break-inside: avoid;
                margin: 20px 0;
            }
            
            .table-container {
                overflow: visible;
            }
            
            table {
                min-width: auto;
            }
            
            .section:hover {
                transform: none;
            }
        }
        
        @media (max-width: 1200px) {
            .container {
                padding: 10px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .dashboard-header h1 {
                font-size: 1.8rem;
            }
            
            .section-header {
                padding: 15px 20px;
                font-size: 1.1rem;
                flex-direction: column;
                gap: 10px;
                align-items: flex-start;
            }
            
            .section-header.vehicle-planning {
                align-items: center;
            }
            
            th, td {
                padding: 10px 12px;
                font-size: 0.9rem;
            }
            
            .controls {
                flex-direction: column;
                gap: 15px;
            }
            
            .control-group {
                width: 100%;
                justify-content: center;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            button {
                padding: 10px 18px;
                font-size: 0.9rem;
            }
            
            .action-btn {
                padding: 8px 15px;
                font-size: 0.85rem;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="controls">
        <div class="control-group">
            <button onclick="scrollToTop()" title="Scroll to top">
                <i class="fas fa-arrow-up"></i> Top
            </button>
            <button onclick="toggleDarkMode()" title="Toggle dark mode">
                <i class="fas fa-moon"></i> Theme
            </button>
        </div>
        
        <div class="control-group">
            <button onclick="printPage()" class="print-btn">
                <i class="fas fa-print"></i> Print Report
            </button>
            <button onclick="exportToExcel()" title="Export to Excel">
                <i class="fas fa-file-excel"></i> Export
            </button>
        </div>
    </div>
    
    <div class="dashboard-header">
        <h1><i class="fas fa-mountain"></i> Quarry Dispatch Dashboard</h1>
        <div class="subtitle">Professional Management Information System for Dispatch Operations</div>
        <div class="date-badge">
            <i class="fas fa-calendar-alt"></i> Current Report: 19-Dec-2025
        </div>
    </div>
    
    <div class="container">
        <!-- Combined Shift Reports in one section -->
        <div class="section" id="shift-reports">
            <div class="section-header orange">
                <span><i class="fas fa-chart-line"></i> SHIFT WISE DISPATCH SUMMARY (19-Dec-2025)</span>
                <span class="total-badge">FTD Total: <span id="ftd-total-badge">0.00</span></span>
            </div>
            
            <!-- A-Shift Section with Full Row Actions -->
            <div class="section">
                <div class="section-header yellow">
                    <span><i class="fas fa-sun"></i> A-Shift Dispatched Details</span>
                    <span class="total-badge" id="a-total-badge">Total: 0.00</span>
                </div>
                
                <!-- Full Row Action Buttons for A-Shift -->
                <div class="full-row-actions">
                    <button class="action-btn add-row" onclick="openAddRowModal('a-shift')">
                        <i class="fas fa-plus-circle"></i> Add A-Shift Row
                    </button>
                    <button class="action-btn edit-row" onclick="editAllRows('a-shift')">
                        <i class="fas fa-edit"></i> Edit All Rows
                    </button>
                    <button class="action-btn delete-row" onclick="deleteAllRows('a-shift')">
                        <i class="fas fa-trash-alt"></i> Clear All Rows
                    </button>
                    <button class="action-btn refresh" onclick="refreshShiftData('a-shift')">
                        <i class="fas fa-sync-alt"></i> Refresh Data
                    </button>
                    <button class="action-btn export" onclick="exportShiftData('a-shift')">
                        <i class="fas fa-download"></i> Export A-Shift
                    </button>
                </div>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Actions</th>
                                <th>Date</th>
                                <th>10 MM</th>
                                <th>20 MM</th>
                                <th>V/SAND</th>
                                <th>P/SAND</th>
                                <th>Scalping</th>
                                <th>GSB / Wet Mix</th>
                                <th>40 MM</th>
                                <th>50 MM</th>
                                <th>R/Sand</th>
                                <th>TOTAL</th>
                            </tr>
                        </thead>
                        <tbody id="a-shift-data">
                            <!-- A-Shift data will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- B-Shift Section with Full Row Actions -->
            <div class="section">
                <div class="section-header yellow">
                    <span><i class="fas fa-moon"></i> B-Shift Dispatched Details</span>
                    <span class="total-badge" id="b-total-badge">Total: 0.00</span>
                </div>
                
                <!-- Full Row Action Buttons for B-Shift -->
                <div class="full-row-actions">
                    <button class="action-btn add-row" onclick="openAddRowModal('b-shift')">
                        <i class="fas fa-plus-circle"></i> Add B-Shift Row
                    </button>
                    <button class="action-btn edit-row" onclick="editAllRows('b-shift')">
                        <i class="fas fa-edit"></i> Edit All Rows
                    </button>
                    <button class="action-btn delete-row" onclick="deleteAllRows('b-shift')">
                        <i class="fas fa-trash-alt"></i> Clear All Rows
                    </button>
                    <button class="action-btn refresh" onclick="refreshShiftData('b-shift')">
                        <i class="fas fa-sync-alt"></i> Refresh Data
                    </button>
                    <button class="action-btn export" onclick="exportShiftData('b-shift')">
                        <i class="fas fa-download"></i> Export B-Shift
                    </button>
                </div>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Actions</th>
                                <th>Date</th>
                                <th>10 MM</th>
                                <th>20 MM</th>
                                <th>V/SAND</th>
                                <th>P/SAND</th>
                                <th>Scalping</th>
                                <th>GSB / Wet Mix</th>
                                <th>40 MM</th>
                                <th>50 MM</th>
                                <th>R/Sand</th>
                                <th>TOTAL</th>
                            </tr>
                        </thead>
                        <tbody id="b-shift-data">
                            <!-- B-Shift data will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- A+B Combined Table -->
            <div class="section" style="margin-top: 20px;">
                <div class="section-header green">
                    <span><i class="fas fa-calculator"></i> A + B SHIFT COMBINED TOTAL</span>
                    <span class="total-badge" id="ab-total-badge">Total: 0.00</span>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Shift</th>
                                <th>10 MM</th>
                                <th>20 MM</th>
                                <th>V/SAND</th>
                                <th>P/SAND</th>
                                <th>Scalping</th>
                                <th>GSB / Wet Mix</th>
                                <th>40 MM</th>
                                <th>50 MM</th>
                                <th>R/Sand</th>
                                <th>TOTAL</th>
                            </tr>
                        </thead>
                        <tbody id="ab-combined-data">
                            <!-- A+B data will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Report 4: FULL DAY – Dispatch Vehicle Wise Planning -->
        <div class="section" id="report6">
            <div class="section-header vehicle-planning">
                <span><i class="fas fa-truck-loading"></i> FULL DAY – Dispatch Vehicle Wise Planning – 23 Aug 2025</span>
            </div>
            <div class="table-container">
                <table class="vehicle-planning-table">
                    <thead>
                        <tr>
                            <th>Client Details</th>
                            <th>Unit</th>
                            <th>10 MM</th>
                            <th>20 MM</th>
                            <th>V/SAND</th>
                            <th>Scalping</th>
                            <th>P/Sand</th>
                            <th>40 MM</th>
                            <th>GSB / WET MIX</th>
                            <th>R/Sand</th>
                            <th>TOTAL</th>
                        </tr>
                    </thead>
                    <tbody id="vehicle-planning-data">
                        <!-- Client data will be populated by JavaScript -->
                    </tbody>
                    <tfoot>
                        <tr class="total-row">
                            <td class="customer-name">GRAND TOTAL (TONNAGE)</td>
                            <td class="customer-name">MT</td>
                            <td class="numeric">141.02</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">131.77</td>
                            <td class="numeric">11.31</td>
                            <td class="numeric">6.11</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">284.10</td>
                        </tr>
                        <tr class="trips-total-row">
                            <td class="customer-name">TOTAL TRIPS</td>
                            <td class="customer-name">Trips</td>
                            <td class="numeric">3</td>
                            <td class="numeric">0</td>
                            <td class="numeric">4</td>
                            <td class="numeric">2</td>
                            <td class="numeric">1</td>
                            <td class="numeric">0</td>
                            <td class="numeric">0</td>
                            <td class="numeric">0</td>
                            <td class="numeric">9</td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
        
        <!-- Report 5: Daily Dispatched Details -->
        <div class="section" id="report4">
            <div class="section-header green">
                <span><i class="fas fa-calendar-day"></i> Dispatched Details (Date-wise) - December 2025</span>
                <span class="total-badge">Total: <span id="daily-total-badge">0.00</span></span>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>10 MM</th>
                            <th>20 MM</th>
                            <th>V/SAND</th>
                            <th>Scalping</th>
                            <th>P/Sand</th>
                            <th>40 MM</th>
                            <th>50 MM</th>
                            <th>GSB/WET MIX</th>
                            <th>R/Sand</th>
                            <th>TOTAL</th>
                        </tr>
                    </thead>
                    <tbody id="daily-data">
                        <!-- Data populated by JavaScript -->
                    </tbody>
                    <tfoot>
                        <tr class="grand-total-row">
                            <td class="customer-name">Total</td>
                            <td class="numeric" id="daily-10mm">0.00</td>
                            <td class="numeric" id="daily-20mm">0.00</td>
                            <td class="numeric" id="daily-vsand">0.00</td>
                            <td class="numeric" id="daily-scalping">0.00</td>
                            <td class="numeric" id="daily-psand">0.00</td>
                            <td class="numeric" id="daily-40mm">0.00</td>
                            <td class="numeric" id="daily-50mm">0.00</td>
                            <td class="numeric" id="daily-gsb">0.00</td>
                            <td class="numeric" id="daily-rsand">0.00</td>
                            <td class="numeric" id="daily-total">0.00</td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
        
        <!-- Report 6: Customer-wise Cumulative Dispatch -->
        <div class="section" id="report5">
            <div class="section-header light-green">
                <span><i class="fas fa-users"></i> DECEMBER-2025 – Customer Wise Cumulative Dispatched Details</span>
                <span class="total-badge">Total Customers: 5</span>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Customer Name</th>
                            <th>10 MM</th>
                            <th>20 MM</th>
                            <th>V/SAND</th>
                            <th>Scalping</th>
                            <th>P/Sand</th>
                            <th>40 MM</th>
                            <th>50 MM</th>
                            <th>GSB/WET MIX</th>
                            <th>R/Sand</th>
                            <th>TOTAL</th>
                            <th>Customer-wise Dispatch Participation (%)</th>
                        </tr>
                    </thead>
                    <tbody id="customer-data">
                        <!-- Data populated by JavaScript -->
                    </tbody>
                    <tfoot>
                        <tr class="total-row">
                            <td class="customer-name">Total</td>
                            <td class="numeric" id="cust-10mm">0.00</td>
                            <td class="numeric" id="cust-20mm">0.00</td>
                            <td class="numeric" id="cust-vsand">0.00</td>
                            <td class="numeric" id="cust-scalping">0.00</td>
                            <td class="numeric" id="cust-psand">0.00</td>
                            <td class="numeric" id="cust-40mm">0.00</td>
                            <td class="numeric" id="cust-50mm">0.00</td>
                            <td class="numeric" id="cust-gsb">0.00</td>
                            <td class="numeric" id="cust-rsand">0.00</td>
                            <td class="numeric" id="cust-total">0.00</td>
                            <td class="numeric">100.00%</td>
                        </tr>
                        <tr class="material-percent-row">
                            <td class="customer-name"><i class="fas fa-chart-pie"></i> Material Wise (%) Participation</td>
                            <td class="numeric" id="mat-10mm">0.00%</td>
                            <td class="numeric" id="mat-20mm">0.00%</td>
                            <td class="numeric" id="mat-vsand">0.00%</td>
                            <td class="numeric" id="mat-scalping">0.00%</td>
                            <td class="numeric" id="mat-psand">0.00%</td>
                            <td class="numeric" id="mat-40mm">0.00%</td>
                            <td class="numeric" id="mat-50mm">0.00%</td>
                            <td class="numeric" id="mat-gsb">0.00%</td>
                            <td class="numeric" id="mat-rsand">0.00%</td>
                            <td class="numeric" id="mat-total">100.00%</td>
                            <td class="numeric">-</td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </div>
    
    <!-- Add/Edit Row Modal -->
    <div class="modal" id="addRowModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">Add New Shift Row</h3>
                <button class="close-modal" onclick="closeModal()">&times;</button>
            </div>
            <div class="form-grid">
                <div class="form-group">
                    <label for="modalDate">Date</label>
                    <input type="date" id="modalDate" value="2025-12-19">
                </div>
                <div class="form-group">
                    <label for="modal10mm">10 MM (MT)</label>
                    <input type="number" id="modal10mm" step="0.01" placeholder="Enter quantity">
                </div>
                <div class="form-group">
                    <label for="modal20mm">20 MM (MT)</label>
                    <input type="number" id="modal20mm" step="0.01" placeholder="Enter quantity">
                </div>
                <div class="form-group">
                    <label for="modalVsand">V/SAND (MT)</label>
                    <input type="number" id="modalVsand" step="0.01" placeholder="Enter quantity">
                </div>
                <div class="form-group">
                    <label for="modalPsand">P/SAND (MT)</label>
                    <input type="number" id="modalPsand" step="0.01" placeholder="Enter quantity">
                </div>
                <div class="form-group">
                    <label for="modalScalping">Scalping (MT)</label>
                    <input type="number" id="modalScalping" step="0.01" placeholder="Enter quantity">
                </div>
                <div class="form-group">
                    <label for="modalGsb">GSB / Wet Mix (MT)</label>
                    <input type="number" id="modalGsb" step="0.01" placeholder="Enter quantity">
                </div>
                <div class="form-group">
                    <label for="modal40mm">40 MM (MT)</label>
                    <input type="number" id="modal40mm" step="0.01" placeholder="Enter quantity">
                </div>
                <div class="form-group">
                    <label for="modal50mm">50 MM (MT)</label>
                    <input type="number" id="modal50mm" step="0.01" placeholder="Enter quantity">
                </div>
                <div class="form-group">
                    <label for="modalRsand">R/Sand (MT)</label>
                    <input type="number" id="modalRsand" step="0.01" placeholder="Enter quantity">
                </div>
            </div>
            <div class="form-actions">
                <button class="action-btn delete-row" onclick="closeModal()">
                    <i class="fas fa-times"></i> Cancel
                </button>
                <button class="action-btn add-row" id="modalSubmitBtn" onclick="submitRow()">
                    <i class="fas fa-save"></i> Save Row
                </button>
            </div>
        </div>
    </div>
    
    <div class="nav-buttons">
        <button onclick="scrollToReport('shift-reports')" class="nav-btn">
            <i class="fas fa-chart-line"></i> Shift Reports
        </button>
        <button onclick="scrollToReport('report6')" class="nav-btn">
            <i class="fas fa-truck-loading"></i> Vehicle Planning
        </button>
        <button onclick="scrollToReport('report4')" class="nav-btn">
            <i class="fas fa-calendar-day"></i> Daily Details
        </button>
        <button onclick="scrollToReport('report5')" class="nav-btn">
            <i class="fas fa-users"></i> Customer-wise
        </button>
    </div>
    
    <div class="scroll-indicator">
        <i class="fas fa-arrows-alt-h"></i> Scroll horizontally to view full table on mobile devices
    </div>
    
    <script>
        // Initialize data and calculations
        let currentShift = '';
        let currentRowIndex = -1;
        let isEditing = false;
        let aShiftData = [];
        let bShiftData = [];
        
        document.addEventListener('DOMContentLoaded', function() {
            initializeShiftData();
            initializeDailyData();
            initializeCustomerData();
            initializeVehiclePlanningData();
            calculateAllTotals();
            updateStats();
        });
        
        // Initialize shift data with multiple rows
        function initializeShiftData() {
            // Generate initial data for A-Shift (3 rows)
            aShiftData = [];
            for (let i = 0; i < 3; i++) {
                aShiftData.push({
                    id: Date.now() + i,
                    date: '19-Dec-2025',
                    mm10: parseFloat((Math.random() * 50).toFixed(2)),
                    mm20: parseFloat((Math.random() * 60).toFixed(2)),
                    vsand: parseFloat((Math.random() * 40).toFixed(2)),
                    psand: parseFloat((Math.random() * 80).toFixed(2)),
                    scalping: parseFloat((Math.random() * 30).toFixed(2)),
                    gsb: parseFloat((Math.random() * 25).toFixed(2)),
                    mm40: parseFloat((Math.random() * 35).toFixed(2)),
                    mm50: parseFloat((Math.random() * 20).toFixed(2)),
                    rsand: parseFloat((Math.random() * 45).toFixed(2))
                });
            }
            
            // Generate initial data for B-Shift (3 rows)
            bShiftData = [];
            for (let i = 0; i < 3; i++) {
                bShiftData.push({
                    id: Date.now() + i + 1000,
                    date: '19-Dec-2025',
                    mm10: parseFloat((Math.random() * 60).toFixed(2)),
                    mm20: parseFloat((Math.random() * 70).toFixed(2)),
                    vsand: parseFloat((Math.random() * 50).toFixed(2)),
                    psand: parseFloat((Math.random() * 90).toFixed(2)),
                    scalping: parseFloat((Math.random() * 40).toFixed(2)),
                    gsb: parseFloat((Math.random() * 35).toFixed(2)),
                    mm40: parseFloat((Math.random() * 45).toFixed(2)),
                    mm50: parseFloat((Math.random() * 30).toFixed(2)),
                    rsand: parseFloat((Math.random() * 55).toFixed(2))
                });
            }
            
            renderShiftData();
        }
        
        // Render shift data to tables
        function renderShiftData() {
            // Clear tables
            document.getElementById('a-shift-data').innerHTML = '';
            document.getElementById('b-shift-data').innerHTML = '';
            
            let aTotal = 0;
            let bTotal = 0;
            
            // Render A-Shift data
            aShiftData.forEach((row, index) => {
                const total = row.mm10 + row.mm20 + row.vsand + row.psand + row.scalping + 
                            row.gsb + row.mm40 + row.mm50 + row.rsand;
                aTotal += total;
                
                const rowHtml = `
                    <tr>
                        <td>
                            <div class="row-actions">
                                <button class="row-action-btn edit" onclick="editRow('a-shift', ${index})" title="Edit">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="row-action-btn delete" onclick="deleteRow('a-shift', ${index})" title="Delete">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                        <td class="date">${row.date}</td>
                        <td class="numeric">${row.mm10.toFixed(2)}</td>
                        <td class="numeric">${row.mm20.toFixed(2)}</td>
                        <td class="numeric">${row.vsand.toFixed(2)}</td>
                        <td class="numeric">${row.psand.toFixed(2)}</td>
                        <td class="numeric">${row.scalping.toFixed(2)}</td>
                        <td class="numeric">${row.gsb.toFixed(2)}</td>
                        <td class="numeric">${row.mm40.toFixed(2)}</td>
                        <td class="numeric">${row.mm50.toFixed(2)}</td>
                        <td class="numeric">${row.rsand.toFixed(2)}</td>
                        <td class="numeric highlight">${total.toFixed(2)}</td>
                    </tr>
                `;
                document.getElementById('a-shift-data').innerHTML += rowHtml;
            });
            
            // Render B-Shift data
            bShiftData.forEach((row, index) => {
                const total = row.mm10 + row.mm20 + row.vsand + row.psand + row.scalping + 
                            row.gsb + row.mm40 + row.mm50 + row.rsand;
                bTotal += total;
                
                const rowHtml = `
                    <tr>
                        <td>
                            <div class="row-actions">
                                <button class="row-action-btn edit" onclick="editRow('b-shift', ${index})" title="Edit">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="row-action-btn delete" onclick="deleteRow('b-shift', ${index})" title="Delete">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                        <td class="date">${row.date}</td>
                        <td class="numeric">${row.mm10.toFixed(2)}</td>
                        <td class="numeric">${row.mm20.toFixed(2)}</td>
                        <td class="numeric">${row.vsand.toFixed(2)}</td>
                        <td class="numeric">${row.psand.toFixed(2)}</td>
                        <td class="numeric">${row.scalping.toFixed(2)}</td>
                        <td class="numeric">${row.gsb.toFixed(2)}</td>
                        <td class="numeric">${row.mm40.toFixed(2)}</td>
                        <td class="numeric">${row.mm50.toFixed(2)}</td>
                        <td class="numeric">${row.rsand.toFixed(2)}</td>
                        <td class="numeric highlight">${total.toFixed(2)}</td>
                    </tr>
                `;
                document.getElementById('b-shift-data').innerHTML += rowHtml;
            });
            
            // Update totals
            document.getElementById('a-total-badge').textContent = `Total: ${aTotal.toFixed(2)}`;
            document.getElementById('b-total-badge').textContent = `Total: ${bTotal.toFixed(2)}`;
            
            // Calculate and update A+B Combined
            updateCombinedTable(aTotal, bTotal);
        }
        
        // Update combined table
        function updateCombinedTable(aTotal, bTotal) {
            // Calculate column totals
            let aCols = {mm10:0, mm20:0, vsand:0, psand:0, scalping:0, gsb:0, mm40:0, mm50:0, rsand:0};
            let bCols = {mm10:0, mm20:0, vsand:0, psand:0, scalping:0, gsb:0, mm40:0, mm50:0, rsand:0};
            
            aShiftData.forEach(row => {
                aCols.mm10 += row.mm10;
                aCols.mm20 += row.mm20;
                aCols.vsand += row.vsand;
                aCols.psand += row.psand;
                aCols.scalping += row.scalping;
                aCols.gsb += row.gsb;
                aCols.mm40 += row.mm40;
                aCols.mm50 += row.mm50;
                aCols.rsand += row.rsand;
            });
            
            bShiftData.forEach(row => {
                bCols.mm10 += row.mm10;
                bCols.mm20 += row.mm20;
                bCols.vsand += row.vsand;
                bCols.psand += row.psand;
                bCols.scalping += row.scalping;
                bCols.gsb += row.gsb;
                bCols.mm40 += row.mm40;
                bCols.mm50 += row.mm50;
                bCols.rsand += row.rsand;
            });
            
            const abCombinedTbody = document.getElementById('ab-combined-data');
            abCombinedTbody.innerHTML = `
                <tr>
                    <td class="customer-name"><i class="fas fa-sun"></i> A Shift Total</td>
                    <td class="numeric">${aCols.mm10.toFixed(2)}</td>
                    <td class="numeric">${aCols.mm20.toFixed(2)}</td>
                    <td class="numeric">${aCols.vsand.toFixed(2)}</td>
                    <td class="numeric">${aCols.psand.toFixed(2)}</td>
                    <td class="numeric">${aCols.scalping.toFixed(2)}</td>
                    <td class="numeric">${aCols.gsb.toFixed(2)}</td>
                    <td class="numeric">${aCols.mm40.toFixed(2)}</td>
                    <td class="numeric">${aCols.mm50.toFixed(2)}</td>
                    <td class="numeric">${aCols.rsand.toFixed(2)}</td>
                    <td class="numeric">${aTotal.toFixed(2)}</td>
                </tr>
                <tr>
                    <td class="customer-name"><i class="fas fa-moon"></i> B Shift Total</td>
                    <td class="numeric">${bCols.mm10.toFixed(2)}</td>
                    <td class="numeric">${bCols.mm20.toFixed(2)}</td>
                    <td class="numeric">${bCols.vsand.toFixed(2)}</td>
                    <td class="numeric">${bCols.psand.toFixed(2)}</td>
                    <td class="numeric">${bCols.scalping.toFixed(2)}</td>
                    <td class="numeric">${bCols.gsb.toFixed(2)}</td>
                    <td class="numeric">${bCols.mm40.toFixed(2)}</td>
                    <td class="numeric">${bCols.mm50.toFixed(2)}</td>
                    <td class="numeric">${bCols.rsand.toFixed(2)}</td>
                    <td class="numeric">${bTotal.toFixed(2)}</td>
                </tr>
                <tr class="grand-total-row">
                    <td class="customer-name"><i class="fas fa-chart-bar"></i> A + B Total</td>
                    <td class="numeric">${(aCols.mm10 + bCols.mm10).toFixed(2)}</td>
                    <td class="numeric">${(aCols.mm20 + bCols.mm20).toFixed(2)}</td>
                    <td class="numeric">${(aCols.vsand + bCols.vsand).toFixed(2)}</td>
                    <td class="numeric">${(aCols.psand + bCols.psand).toFixed(2)}</td>
                    <td class="numeric">${(aCols.scalping + bCols.scalping).toFixed(2)}</td>
                    <td class="numeric">${(aCols.gsb + bCols.gsb).toFixed(2)}</td>
                    <td class="numeric">${(aCols.mm40 + bCols.mm40).toFixed(2)}</td>
                    <td class="numeric">${(aCols.mm50 + bCols.mm50).toFixed(2)}</td>
                    <td class="numeric">${(aCols.rsand + bCols.rsand).toFixed(2)}</td>
                    <td class="numeric">${(aTotal + bTotal).toFixed(2)}</td>
                </tr>
            `;
            
            document.getElementById('ab-total-badge').textContent = `Total: ${(aTotal + bTotal).toFixed(2)}`;
            document.getElementById('ftd-total-badge').textContent = (aTotal + bTotal).toFixed(2);
        }
        
        // Open modal for adding/editing rows
        function openAddRowModal(shift) {
            currentShift = shift;
            currentRowIndex = -1;
            isEditing = false;
            
            document.getElementById('modalTitle').textContent = `Add New ${shift === 'a-shift' ? 'A-Shift' : 'B-Shift'} Row`;
            document.getElementById('modalSubmitBtn').innerHTML = '<i class="fas fa-save"></i> Save Row';
            document.getElementById('modalSubmitBtn').classList.remove('edit-row');
            document.getElementById('modalSubmitBtn').classList.add('add-row');
            
            // Clear form
            document.getElementById('modalDate').value = '2025-12-19';
            document.getElementById('modal10mm').value = '';
            document.getElementById('modal20mm').value = '';
            document.getElementById('modalVsand').value = '';
            document.getElementById('modalPsand').value = '';
            document.getElementById('modalScalping').value = '';
            document.getElementById('modalGsb').value = '';
            document.getElementById('modal40mm').value = '';
            document.getElementById('modal50mm').value = '';
            document.getElementById('modalRsand').value = '';
            
            document.getElementById('addRowModal').style.display = 'flex';
        }
        
        // Edit specific row
        function editRow(shift, index) {
            currentShift = shift;
            currentRowIndex = index;
            isEditing = true;
            
            const data = shift === 'a-shift' ? aShiftData[index] : bShiftData[index];
            
            document.getElementById('modalTitle').textContent = `Edit ${shift === 'a-shift' ? 'A-Shift' : 'B-Shift'} Row`;
            document.getElementById('modalSubmitBtn').innerHTML = '<i class="fas fa-save"></i> Update Row';
            document.getElementById('modalSubmitBtn').classList.remove('add-row');
            document.getElementById('modalSubmitBtn').classList.add('edit-row');
            
            // Fill form with existing data
            document.getElementById('modalDate').value = '2025-12-19';
            document.getElementById('modal10mm').value = data.mm10;
            document.getElementById('modal20mm').value = data.mm20;
            document.getElementById('modalVsand').value = data.vsand;
            document.getElementById('modalPsand').value = data.psand;
            document.getElementById('modalScalping').value = data.scalping;
            document.getElementById('modalGsb').value = data.gsb;
            document.getElementById('modal40mm').value = data.mm40;
            document.getElementById('modal50mm').value = data.mm50;
            document.getElementById('modalRsand').value = data.rsand;
            
            document.getElementById('addRowModal').style.display = 'flex';
        }
        
        // Edit all rows (placeholder)
        function editAllRows(shift) {
            alert(`Edit all rows functionality for ${shift} would be implemented in a full application.`);
        }
        
        // Submit row (add or edit)
        function submitRow() {
            const rowData = {
                id: isEditing ? (currentShift === 'a-shift' ? aShiftData[currentRowIndex].id : bShiftData[currentRowIndex].id) : Date.now(),
                date: '19-Dec-2025',
                mm10: parseFloat(document.getElementById('modal10mm').value) || 0,
                mm20: parseFloat(document.getElementById('modal20mm').value) || 0,
                vsand: parseFloat(document.getElementById('modalVsand').value) || 0,
                psand: parseFloat(document.getElementById('modalPsand').value) || 0,
                scalping: parseFloat(document.getElementById('modalScalping').value) || 0,
                gsb: parseFloat(document.getElementById('modalGsb').value) || 0,
                mm40: parseFloat(document.getElementById('modal40mm').value) || 0,
                mm50: parseFloat(document.getElementById('modal50mm').value) || 0,
                rsand: parseFloat(document.getElementById('modalRsand').value) || 0
            };
            
            if (isEditing) {
                if (currentShift === 'a-shift') {
                    aShiftData[currentRowIndex] = rowData;
                } else {
                    bShiftData[currentRowIndex] = rowData;
                }
            } else {
                if (currentShift === 'a-shift') {
                    aShiftData.push(rowData);
                } else {
                    bShiftData.push(rowData);
                }
            }
            
            closeModal();
            renderShiftData();
        }
        
        // Delete specific row
        function deleteRow(shift, index) {
            if (confirm('Are you sure you want to delete this row?')) {
                if (shift === 'a-shift') {
                    aShiftData.splice(index, 1);
                } else {
                    bShiftData.splice(index, 1);
                }
                renderShiftData();
            }
        }
        
        // Delete all rows
        function deleteAllRows(shift) {
            if (confirm(`Are you sure you want to clear all ${shift} data? This cannot be undone.`)) {
                if (shift === 'a-shift') {
                    aShiftData = [];
                } else {
                    bShiftData = [];
                }
                renderShiftData();
            }
        }
        
        // Refresh shift data
        function refreshShiftData(shift) {
            if (confirm(`Refresh ${shift} data with random values?`)) {
                if (shift === 'a-shift') {
                    aShiftData.forEach(row => {
                        row.mm10 = parseFloat((Math.random() * 50).toFixed(2));
                        row.mm20 = parseFloat((Math.random() * 60).toFixed(2));
                        row.vsand = parseFloat((Math.random() * 40).toFixed(2));
                        row.psand = parseFloat((Math.random() * 80).toFixed(2));
                        row.scalping = parseFloat((Math.random() * 30).toFixed(2));
                        row.gsb = parseFloat((Math.random() * 25).toFixed(2));
                        row.mm40 = parseFloat((Math.random() * 35).toFixed(2));
                        row.mm50 = parseFloat((Math.random() * 20).toFixed(2));
                        row.rsand = parseFloat((Math.random() * 45).toFixed(2));
                    });
                } else {
                    bShiftData.forEach(row => {
                        row.mm10 = parseFloat((Math.random() * 60).toFixed(2));
                        row.mm20 = parseFloat((Math.random() * 70).toFixed(2));
                        row.vsand = parseFloat((Math.random() * 50).toFixed(2));
                        row.psand = parseFloat((Math.random() * 90).toFixed(2));
                        row.scalping = parseFloat((Math.random() * 40).toFixed(2));
                        row.gsb = parseFloat((Math.random() * 35).toFixed(2));
                        row.mm40 = parseFloat((Math.random() * 45).toFixed(2));
                        row.mm50 = parseFloat((Math.random() * 30).toFixed(2));
                        row.rsand = parseFloat((Math.random() * 55).toFixed(2));
                    });
                }
                renderShiftData();
            }
        }
        
        // Export shift data
        function exportShiftData(shift) {
            const data = shift === 'a-shift' ? aShiftData : bShiftData;
            let csvContent = "data:text/csv;charset=utf-8,";
            csvContent += "Date,10 MM,20 MM,V/SAND,P/SAND,Scalping,GSB/Wet Mix,40 MM,50 MM,R/Sand,TOTAL\n";
            
            data.forEach(row => {
                const total = row.mm10 + row.mm20 + row.vsand + row.psand + row.scalping + 
                            row.gsb + row.mm40 + row.mm50 + row.rsand;
                csvContent += `${row.date},${row.mm10},${row.mm20},${row.vsand},${row.psand},${row.scalping},${row.gsb},${row.mm40},${row.mm50},${row.rsand},${total}\n`;
            });
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", `${shift}_data_${new Date().toISOString().split('T')[0]}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        // Close modal
        function closeModal() {
            document.getElementById('addRowModal').style.display = 'none';
        }
        
        // Daily data for December 1-19, 2025 with random values for all columns
        function initializeDailyData() {
            const tbody = document.getElementById('daily-data');
            let totalMm10 = 0, totalMm20 = 0, totalVsand = 0, totalScalping = 0, totalPsand = 0;
            let totalMm40 = 0, totalMm50 = 0, totalGsb = 0, totalRsand = 0, grandTotal = 0;
            
            for (let i = 1; i <= 19; i++) {
                const day = {
                    date: `${i}-Dec-2025`,
                    mm10: parseFloat((Math.random() * 200).toFixed(2)),
                    mm20: parseFloat((Math.random() * 180).toFixed(2)),
                    vsand: parseFloat((Math.random() * 150).toFixed(2)),
                    scalping: parseFloat((Math.random() * 100).toFixed(2)),
                    psand: parseFloat((Math.random() * 250).toFixed(2)),
                    mm40: parseFloat((Math.random() * 120).toFixed(2)),
                    mm50: parseFloat((Math.random() * 90).toFixed(2)),
                    gsb: parseFloat((Math.random() * 140).toFixed(2)),
                    rsand: parseFloat((Math.random() * 110).toFixed(2))
                };
                
                const total = day.mm10 + day.mm20 + day.vsand + day.scalping + day.psand + 
                             day.mm40 + day.mm50 + day.gsb + day.rsand;
                
                const isToday = i === 19;
                const rowClass = isToday ? 'highlight' : '';
                
                // Update totals
                totalMm10 += day.mm10;
                totalMm20 += day.mm20;
                totalVsand += day.vsand;
                totalScalping += day.scalping;
                totalPsand += day.psand;
                totalMm40 += day.mm40;
                totalMm50 += day.mm50;
                totalGsb += day.gsb;
                totalRsand += day.rsand;
                grandTotal += total;
                
                const row = `
                    <tr>
                        <td class="date ${rowClass}">${day.date}${isToday ? ' <i class="fas fa-star" style="color: #e67e22;"></i>' : ''}</td>
                        <td class="numeric ${rowClass}">${day.mm10.toFixed(2)}</td>
                        <td class="numeric ${rowClass}">${day.mm20.toFixed(2)}</td>
                        <td class="numeric ${rowClass}">${day.vsand.toFixed(2)}</td>
                        <td class="numeric ${rowClass}">${day.scalping.toFixed(2)}</td>
                        <td class="numeric ${rowClass}">${day.psand.toFixed(2)}</td>
                        <td class="numeric ${rowClass}">${day.mm40.toFixed(2)}</td>
                        <td class="numeric ${rowClass}">${day.mm50.toFixed(2)}</td>
                        <td class="numeric ${rowClass}">${day.gsb.toFixed(2)}</td>
                        <td class="numeric ${rowClass}">${day.rsand.toFixed(2)}</td>
                        <td class="numeric ${rowClass}">${total.toFixed(2)}</td>
                    </tr>
                `;
                tbody.innerHTML += row;
            }
            
            // Update total row
            document.getElementById('daily-10mm').textContent = totalMm10.toFixed(2);
            document.getElementById('daily-20mm').textContent = totalMm20.toFixed(2);
            document.getElementById('daily-vsand').textContent = totalVsand.toFixed(2);
            document.getElementById('daily-scalping').textContent = totalScalping.toFixed(2);
            document.getElementById('daily-psand').textContent = totalPsand.toFixed(2);
            document.getElementById('daily-40mm').textContent = totalMm40.toFixed(2);
            document.getElementById('daily-50mm').textContent = totalMm50.toFixed(2);
            document.getElementById('daily-gsb').textContent = totalGsb.toFixed(2);
            document.getElementById('daily-rsand').textContent = totalRsand.toFixed(2);
            document.getElementById('daily-total').textContent = grandTotal.toFixed(2);
            document.getElementById('daily-total-badge').textContent = grandTotal.toFixed(2);
        }
        
        // Customer data with random values for all columns
        function initializeCustomerData() {
            const customerData = [
                { name: 'Construction Corp A' },
                { name: 'Infra Builders Ltd' },
                { name: 'Mega Projects Inc' },
                { name: 'Roadways Const. Co.' },
                { name: 'Urban Developers' }
            ];
            
            const tbody = document.getElementById('customer-data');
            let totalMm10 = 0, totalMm20 = 0, totalVsand = 0, totalScalping = 0, totalPsand = 0;
            let totalMm40 = 0, totalMm50 = 0, totalGsb = 0, totalRsand = 0, grandTotal = 0;
            
            customerData.forEach((cust, index) => {
                const custData = {
                    mm10: parseFloat((Math.random() * 1500).toFixed(2)),
                    mm20: parseFloat((Math.random() * 1200).toFixed(2)),
                    vsand: parseFloat((Math.random() * 1800).toFixed(2)),
                    scalping: parseFloat((Math.random() * 800).toFixed(2)),
                    psand: parseFloat((Math.random() * 2500).toFixed(2)),
                    mm40: parseFloat((Math.random() * 900).toFixed(2)),
                    mm50: parseFloat((Math.random() * 600).toFixed(2)),
                    gsb: parseFloat((Math.random() * 1400).toFixed(2)),
                    rsand: parseFloat((Math.random() * 1000).toFixed(2))
                };
                
                const total = custData.mm10 + custData.mm20 + custData.vsand + custData.scalping + custData.psand + 
                             custData.mm40 + custData.mm50 + custData.gsb + custData.rsand;
                
                // Update totals
                totalMm10 += custData.mm10;
                totalMm20 += custData.mm20;
                totalVsand += custData.vsand;
                totalScalping += custData.scalping;
                totalPsand += custData.psand;
                totalMm40 += custData.mm40;
                totalMm50 += custData.mm50;
                totalGsb += custData.gsb;
                totalRsand += custData.rsand;
                grandTotal += total;
                
                const row = `
                    <tr>
                        <td class="customer-name"><i class="fas fa-building"></i> ${cust.name}</td>
                        <td class="numeric">${custData.mm10.toFixed(2)}</td>
                        <td class="numeric">${custData.mm20.toFixed(2)}</td>
                        <td class="numeric">${custData.vsand.toFixed(2)}</td>
                        <td class="numeric">${custData.scalping.toFixed(2)}</td>
                        <td class="numeric">${custData.psand.toFixed(2)}</td>
                        <td class="numeric">${custData.mm40.toFixed(2)}</td>
                        <td class="numeric">${custData.mm50.toFixed(2)}</td>
                        <td class="numeric">${custData.gsb.toFixed(2)}</td>
                        <td class="numeric">${custData.rsand.toFixed(2)}</td>
                        <td class="numeric">${total.toFixed(2)}</td>
                        <td class="numeric">${((total / grandTotal) * 100).toFixed(2)}%</td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
            
            // Update totals in footer
            document.getElementById('cust-10mm').textContent = totalMm10.toFixed(2);
            document.getElementById('cust-20mm').textContent = totalMm20.toFixed(2);
            document.getElementById('cust-vsand').textContent = totalVsand.toFixed(2);
            document.getElementById('cust-scalping').textContent = totalScalping.toFixed(2);
            document.getElementById('cust-psand').textContent = totalPsand.toFixed(2);
            document.getElementById('cust-40mm').textContent = totalMm40.toFixed(2);
            document.getElementById('cust-50mm').textContent = totalMm50.toFixed(2);
            document.getElementById('cust-gsb').textContent = totalGsb.toFixed(2);
            document.getElementById('cust-rsand').textContent = totalRsand.toFixed(2);
            document.getElementById('cust-total').textContent = grandTotal.toFixed(2);
            
            // Update material-wise percentages
            document.getElementById('mat-10mm').textContent = ((totalMm10 / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-20mm').textContent = ((totalMm20 / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-vsand').textContent = ((totalVsand / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-scalping').textContent = ((totalScalping / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-psand').textContent = ((totalPsand / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-40mm').textContent = ((totalMm40 / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-50mm').textContent = ((totalMm50 / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-gsb').textContent = ((totalGsb / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-rsand').textContent = ((totalRsand / grandTotal) * 100).toFixed(2) + '%';
        }
        
        // Vehicle Planning Data
        function initializeVehiclePlanningData() {
            const vehicleData = [
                {
                    client: 'L & T P2 – Rambali',
                    tonnage: { mm10: 99.96, mm20: 0, vsand: 67.70, scalping: 0, psand: 0, mm40: 0, gsb: 0, rsand: 0 },
                    trips: { mm10: 2, mm20: 0, vsand: 2, scalping: 0, psand: 0, mm40: 0, gsb: 0, rsand: 0 }
                },
                {
                    client: 'ACC RMC – Gajuwaka',
                    tonnage: { mm10: 0, mm20: 0, vsand: 22.80, scalping: 0, psand: 0, mm40: 0, gsb: 0, rsand: 0 },
                    trips: { mm10: 0, mm20: 0, vsand: 1, scalping: 0, psand: 0, mm40: 0, gsb: 0, rsand: 0 }
                },
                {
                    client: 'Prasant Maravaram',
                    tonnage: { mm10: 0, mm20: 0, vsand: 0, scalping: 5.20, psand: 0, mm40: 0, gsb: 0, rsand: 0 },
                    trips: { mm10: 0, mm20: 0, vsand: 0, scalping: 1, psand: 0, mm40: 0, gsb: 0, rsand: 0 }
                },
                {
                    client: 'MK Builders – Madhurwada',
                    tonnage: { mm10: 41.06, mm20: 0, vsand: 41.27, scalping: 0, psand: 0, mm40: 0, gsb: 0, rsand: 0 },
                    trips: { mm10: 1, mm20: 0, vsand: 1, scalping: 0, psand: 0, mm40: 0, gsb: 0, rsand: 0 }
                },
                {
                    client: 'Prasad Makavaram',
                    tonnage: { mm10: 0, mm20: 0, vsand: 0, scalping: 6.11, psand: 0, mm40: 0, gsb: 0, rsand: 0 },
                    trips: { mm10: 0, mm20: 0, vsand: 0, scalping: 1, psand: 0, mm40: 0, gsb: 0, rsand: 0 }
                }
            ];
            
            const tbody = document.getElementById('vehicle-planning-data');
            
            vehicleData.forEach(clientData => {
                // Calculate totals
                const tonnageTotal = clientData.tonnage.mm10 + clientData.tonnage.mm20 + clientData.tonnage.vsand + 
                                    clientData.tonnage.scalping + clientData.tonnage.psand + clientData.tonnage.mm40 + 
                                    clientData.tonnage.gsb + clientData.tonnage.rsand;
                
                const tripsTotal = clientData.trips.mm10 + clientData.trips.mm20 + clientData.trips.vsand + 
                                 clientData.trips.scalping + clientData.trips.psand + clientData.trips.mm40 + 
                                 clientData.trips.gsb + clientData.trips.rsand;
                
                // Tonnage Row
                const tonnageRow = `
                    <tr>
                        <td class="client-name-cell">${clientData.client}</td>
                        <td class="customer-name">Total Tonnage (MT)</td>
                        <td class="numeric">${clientData.tonnage.mm10 === 0 ? '' : clientData.tonnage.mm10.toFixed(2)}</td>
                        <td class="numeric">${clientData.tonnage.mm20 === 0 ? '' : clientData.tonnage.mm20.toFixed(2)}</td>
                        <td class="numeric">${clientData.tonnage.vsand === 0 ? '' : clientData.tonnage.vsand.toFixed(2)}</td>
                        <td class="numeric">${clientData.tonnage.scalping === 0 ? '' : clientData.tonnage.scalping.toFixed(2)}</td>
                        <td class="numeric">${clientData.tonnage.psand === 0 ? '' : clientData.tonnage.psand.toFixed(2)}</td>
                        <td class="numeric">${clientData.tonnage.mm40 === 0 ? '' : clientData.tonnage.mm40.toFixed(2)}</td>
                        <td class="numeric">${clientData.tonnage.gsb === 0 ? '' : clientData.tonnage.gsb.toFixed(2)}</td>
                        <td class="numeric">${clientData.tonnage.rsand === 0 ? '' : clientData.tonnage.rsand.toFixed(2)}</td>
                        <td class="numeric">${tonnageTotal.toFixed(2)}</td>
                    </tr>
                `;
                
                // Trips Row
                const tripsRow = `
                    <tr>
                        <td class="client-name-cell" style="border-top: none;"></td>
                        <td class="customer-name">Total Trips</td>
                        <td class="numeric">${clientData.trips.mm10 === 0 ? '' : clientData.trips.mm10}</td>
                        <td class="numeric">${clientData.trips.mm20 === 0 ? '' : clientData.trips.mm20}</td>
                        <td class="numeric">${clientData.trips.vsand === 0 ? '' : clientData.trips.vsand}</td>
                        <td class="numeric">${clientData.trips.scalping === 0 ? '' : clientData.trips.scalping}</td>
                        <td class="numeric">${clientData.trips.psand === 0 ? '' : clientData.trips.psand}</td>
                        <td class="numeric">${clientData.trips.mm40 === 0 ? '' : clientData.trips.mm40}</td>
                        <td class="numeric">${clientData.trips.gsb === 0 ? '' : clientData.trips.gsb}</td>
                        <td class="numeric">${clientData.trips.rsand === 0 ? '' : clientData.trips.rsand}</td>
                        <td class="numeric">${tripsTotal}</td>
                    </tr>
                `;
                
                tbody.innerHTML += tonnageRow + tripsRow;
            });
        }
        
        // Calculate all totals
        function calculateAllTotals() {
            console.log("All totals calculated");
        }
        
        // Update statistics
        function updateStats() {
            console.log("Dashboard stats updated");
        }
        
        // Navigation functions
        function scrollToReport(reportId) {
            const report = document.getElementById(reportId);
            if (report) {
                report.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }
        
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        function printPage() {
            window.print();
        }
        
        function exportToExcel() {
            alert('Excel export functionality would be implemented here with a backend connection.');
        }
        
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            alert('Dark mode toggle would change theme colors in a full implementation.');
        }
        
        // Refresh all data
        function refreshData() {
            initializeShiftData();
            renderShiftData();
        }
    </script>
</body>
</html>
