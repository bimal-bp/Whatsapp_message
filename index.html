<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quarry / Crusher Dispatch Reports - December 2025</title>
    <style>
        body {
            font-family: 'Segoe UI', Roboto, sans-serif;
            background-color: #f5f5f5;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            margin-bottom: 40px;
        }
        .print-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            z-index: 1000;
        }
        .print-btn:hover {
            background: #0056b3;
        }
        .report-section {
            margin-bottom: 60px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .report-header {
            padding: 15px;
            margin: -20px -20px 20px -20px;
            border-radius: 10px 10px 0 0;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: right;
        }
        th {
            background-color: #f0f0f0;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        th:first-child, td:first-child {
            text-align: center;
        }
        th:nth-child(1), td:nth-child(1) {
            text-align: center;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .total-row {
            font-weight: bold;
            background-color: #d4edda !important;
        }
        .grand-total-row {
            font-weight: bold;
            background-color: #198754 !important;
            color: white;
        }
        .yellow-total {
            background-color: #ffff99 !important;
            font-weight: bold;
        }
        .numeric {
            text-align: right;
        }
        @media print {
            body { padding: 0; background: white; }
            .print-btn { display: none; }
            .report-section {
                box-shadow: none;
                page-break-after: always;
                margin-bottom: 0;
            }
            .report-section:last-child { page-break-after: avoid; }
            .container { max-width: none; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Quarry / Crusher Dispatch Reports<br>December 2025 (as of 19-Dec-2025)</h1>
        <button class="print-btn" onclick="window.print()">Print Reports</button>

        <!-- Report 1: A-Shift -->
        <div class="report-section" id="a-shift">
            <div class="report-header" style="background:#ffff99; color:#cc0000;">
                A-Shift Dispatched Details
            </div>
            <table>
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>10 MM</th>
                        <th>20 MM</th>
                        <th>V/SAND</th>
                        <th>P/SAND</th>
                        <th>Scalping</th>
                        <th>GSB / Wet Mix</th>
                        <th>40 MM</th>
                        <th>50 MM</th>
                        <th>R/Sand</th>
                        <th>TOTAL</th>
                    </tr>
                </thead>
                <tbody id="a-shift-body">
                    <!-- Data rows will be inserted by JS -->
                </tbody>
                <tfoot>
                    <tr class="total-row">
                        <td>Total</td>
                        <td class="a-total-10mm">0.00</td>
                        <td class="a-total-20mm">0.00</td>
                        <td class="a-total-vsand">0.00</td>
                        <td class="a-total-psand">0.00</td>
                        <td class="a-total-scalping">0.00</td>
                        <td class="a-total-gsb">0.00</td>
                        <td class="a-total-40mm">0.00</td>
                        <td class="a-total-50mm">0.00</td>
                        <td class="a-total-rsand">0.00</td>
                        <td class="a-total-total">0.00</td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <!-- Report 2: B-Shift -->
        <div class="report-section" id="b-shift">
            <div class="report-header" style="background:#ffff99; color:#cc0000;">
                B-Shift Dispatched Details
            </div>
            <table>
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>10 MM</th>
                        <th>20 MM</th>
                        <th>V/SAND</th>
                        <th>P/SAND</th>
                        <th>Scalping</th>
                        <th>GSB / Wet Mix</th>
                        <th>40 MM</th>
                        <th>50 MM</th>
                        <th>R/Sand</th>
                        <th>TOTAL</th>
                    </tr>
                </thead>
                <tbody id="b-shift-body">
                    <!-- Data rows will be inserted by JS -->
                </tbody>
                <tfoot>
                    <tr class="total-row">
                        <td>Total</td>
                        <td class="b-total-10mm">0.00</td>
                        <td class="b-total-20mm">0.00</td>
                        <td class="b-total-vsand">0.00</td>
                        <td class="b-total-psand">0.00</td>
                        <td class="b-total-scalping">0.00</td>
                        <td class="b-total-gsb">0.00</td>
                        <td class="b-total-40mm">0.00</td>
                        <td class="b-total-50mm">0.00</td>
                        <td class="b-total-rsand">0.00</td>
                        <td class="b-total-total">0.00</td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <!-- Report 3: FTD Summary -->
        <div class="report-section" id="ftd-summary">
            <div class="report-header" style="background:#ffb366; color:black;">
                FTD Dispatched Summary (A Shift + B Shift)
            </div>
            <table>
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>10 MM</th>
                        <th>20 MM</th>
                        <th>V/SAND</th>
                        <th>P/SAND</th>
                        <th>Scalping</th>
                        <th>GSB / Wet Mix</th>
                        <th>40 MM</th>
                        <th>50 MM</th>
                        <th>R/Sand</th>
                        <th>TOTAL</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>19-Dec-2025</td>
                        <td id="ftd-10mm">0.00</td>
                        <td id="ftd-20mm">0.00</td>
                        <td id="ftd-vsand">0.00</td>
                        <td id="ftd-psand">0.00</td>
                        <td id="ftd-scalping">0.00</td>
                        <td id="ftd-gsb">0.00</td>
                        <td id="ftd-40mm">0.00</td>
                        <td id="ftd-50mm">0.00</td>
                        <td id="ftd-rsand">0.00</td>
                        <td id="ftd-total">0.00</td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr class="grand-total-row">
                        <td>Grand Total</td>
                        <td id="ftd-grand-10mm">0.00</td>
                        <td id="ftd-grand-20mm">0.00</td>
                        <td id="ftd-grand-vsand">0.00</td>
                        <td id="ftd-grand-psand">0.00</td>
                        <td id="ftd-grand-scalping">0.00</td>
                        <td id="ftd-grand-gsb">0.00</td>
                        <td id="ftd-grand-40mm">0.00</td>
                        <td id="ftd-grand-50mm">0.00</td>
                        <td id="ftd-grand-rsand">0.00</td>
                        <td id="ftd-grand-total">0.00</td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <!-- Report 4: Daily Dispatched Details -->
        <div class="report-section" id="daily-details">
            <div class="report-header" style="background:#99cc99; color:#cc0000;">
                Dispatched Details
            </div>
            <table>
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>10 MM</th>
                        <th>20 MM</th>
                        <th>V/SAND</th>
                        <th>Scalping</th>
                        <th>P/Sand</th>
                        <th>40 MM</th>
                        <th>50 MM</th>
                        <th>GSB/WET MIX</th>
                        <th>R/Sand</th>
                        <th>TOTAL</th>
                    </tr>
                </thead>
                <tbody id="daily-body">
                    <!-- Rows from 01 to 19 Dec 2025 -->
                </tbody>
                <tfoot>
                    <tr class="total-row">
                        <td>Total</td>
                        <td id="daily-total-10mm">0.00</td>
                        <td id="daily-total-20mm">0.00</td>
                        <td id="daily-total-vsand">0.00</td>
                        <td id="daily-total-scalping">0.00</td>
                        <td id="daily-total-psand">0.00</td>
                        <td id="daily-total-40mm">0.00</td>
                        <td id="daily-total-50mm">0.00</td>
                        <td id="daily-total-gsb">0.00</td>
                        <td id="daily-total-rsand">0.00</td>
                        <td id="daily-total-total">0.00</td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <!-- Report 5: Customer-wise Cumulative -->
        <div class="report-section" id="customer-wise">
            <div class="report-header" style="background:#e6f3e6; color:#cc0000;">
                DECEMBER-2025 â€“ Customer Wise Cumulative Dispatched Details
            </div>
            <table>
                <thead>
                    <tr>
                        <th style="text-align:left;">Customer Name</th>
                        <th>10 MM</th>
                        <th>20 MM</th>
                        <th>V/SAND</th>
                        <th>Scalping</th>
                        <th>P/Sand</th>
                        <th>40 MM</th>
                        <th>50 MM</th>
                        <th>GSB/WET MIX</th>
                        <th>R/Sand</th>
                        <th>TOTAL</th>
                        <th>Customer-wise Dispatch Participation (%)</th>
                    </tr>
                </thead>
                <tbody id="customer-body">
                    <!-- Customer rows -->
                </tbody>
                <tfoot>
                    <tr class="yellow-total">
                        <td>Total</td>
                        <td id="cust-total-10mm">0.00</td>
                        <td id="cust-total-20mm">0.00</td>
                        <td id="cust-total-vsand">0.00</td>
                        <td id="cust-total-scalping">0.00</td>
                        <td id="cust-total-psand">0.00</td>
                        <td id="cust-total-40mm">0.00</td>
                        <td id="cust-total-50mm">0.00</td>
                        <td id="cust-total-gsb">0.00</td>
                        <td id="cust-total-rsand">0.00</td>
                        <td id="cust-grand-total">0.00</td>
                        <td>100.00%</td>
                    </tr>
                    <tr class="total-row">
                        <td>Material Wise (%) Participation</td>
                        <td id="mat-pct-10mm">0.00%</td>
                        <td id="mat-pct-20mm">0.00%</td>
                        <td id="mat-pct-vsand">0.00%</td>
                        <td id="mat-pct-scalping">0.00%</td>
                        <td id="mat-pct-psand">0.00%</td>
                        <td id="mat-pct-40mm">0.00%</td>
                        <td id="mat-pct-50mm">0.00%</td>
                        <td id="mat-pct-gsb">0.00%</td>
                        <td id="mat-pct-rsand">0.00%</td>
                        <td>100.00%</td>
                        <td>-</td>
                    </tr>
                </tfoot>
            </table>
        </div>
    </div>

    <script>
        // Helper to format numbers
        function fmt(n) {
            return Number(n).toFixed(2);
        }

        // Sample data - you can expand or replace with real data
        const aShiftData = [
            {date: "19-Dec-2025", p10: 0, p20: 0, vsand: 0, psand: 45.67, scalping: 0, gsb: 0, p40: 0, p50: 0, rsand: 0},
            // Add more days if needed
        ];

        const bShiftData = [
            {date: "19-Dec-2025", p10: 0, p20: 0, vsand: 0, psand: 120.45, scalping: 0, gsb: 0, p40: 0, p50: 0, rsand: 0},
        ];

        // Populate A-Shift
        const aBody = document.getElementById('a-shift-body');
        let aTotals = {p10:0, p20:0, vsand:0, psand:0, scalping:0, gsb:0, p40:0, p50:0, rsand:0, total:0};
        aShiftData.forEach(row => {
            const tr = document.createElement('tr');
            const rowTotal = row.p10 + row.p20 + row.vsand + row.psand + row.scalping + row.gsb + row.p40 + row.p50 + row.rsand;
            tr.innerHTML = `
                <td>${row.date}</td>
                <td>${fmt(row.p10)}</td>
                <td>${fmt(row.p20)}</td>
                <td>${fmt(row.vsand)}</td>
                <td>${fmt(row.psand)}</td>
                <td>${fmt(row.scalping)}</td>
                <td>${fmt(row.gsb)}</td>
                <td>${fmt(row.p40)}</td>
                <td>${fmt(row.p50)}</td>
                <td>${fmt(row.rsand)}</td>
                <td>${fmt(rowTotal)}</td>
            `;
            aBody.appendChild(tr);

            // Accumulate totals
            aTotals.p10 += row.p10;
            aTotals.p20 += row.p20;
            aTotals.vsand += row.vsand;
            aTotals.psand += row.psand;
            aTotals.scalping += row.scalping;
            aTotals.gsb += row.gsb;
            aTotals.p40 += row.p40;
            aTotals.p50 += row.p50;
            aTotals.rsand += row.rsand;
            aTotals.total += rowTotal;
        });

        // Update A totals
        document.querySelector('.a-total-10mm').textContent = fmt(aTotals.p10);
        document.querySelector('.a-total-20mm').textContent = fmt(aTotals.p20);
        document.querySelector('.a-total-vsand').textContent = fmt(aTotals.vsand);
        document.querySelector('.a-total-psand').textContent = fmt(aTotals.psand);
        document.querySelector('.a-total-scalping').textContent = fmt(aTotals.scalping);
        document.querySelector('.a-total-gsb').textContent = fmt(aTotals.gsb);
        document.querySelector('.a-total-40mm').textContent = fmt(aTotals.p40);
        document.querySelector('.a-total-50mm').textContent = fmt(aTotals.p50);
        document.querySelector('.a-total-rsand').textContent = fmt(aTotals.rsand);
        document.querySelector('.a-total-total').textContent = fmt(aTotals.total);

        // Similar for B-Shift
        const bBody = document.getElementById('b-shift-body');
        let bTotals = {p10:0, p20:0, vsand:0, psand:0, scalping:0, gsb:0, p40:0, p50:0, rsand:0, total:0};
        bShiftData.forEach(row => {
            const tr = document.createElement('tr');
            const rowTotal = row.p10 + row.p20 + row.vsand + row.psand + row.scalping + row.gsb + row.p40 + row.p50 + row.rsand;
            tr.innerHTML = `
                <td>${row.date}</td>
                <td>${fmt(row.p10)}</td>
                <td>${fmt(row.p20)}</td>
                <td>${fmt(row.vsand)}</td>
                <td>${fmt(row.psand)}</td>
                <td>${fmt(row.scalping)}</td>
                <td>${fmt(row.gsb)}</td>
                <td>${fmt(row.p40)}</td>
                <td>${fmt(row.p50)}</td>
                <td>${fmt(row.rsand)}</td>
                <td>${fmt(rowTotal)}</td>
            `;
            bBody.appendChild(tr);

            bTotals.p10 += row.p10;
            bTotals.p20 += row.p20;
            bTotals.vsand += row.vsand;
            bTotals.psand += row.psand;
            bTotals.scalping += row.scalping;
            bTotals.gsb += row.gsb;
            bTotals.p40 += row.p40;
            bTotals.p50 += row.p50;
            bTotals.rsand += row.rsand;
            bTotals.total += rowTotal;
        });

        document.querySelector('.b-total-10mm').textContent = fmt(bTotals.p10);
        document.querySelector('.b-total-20mm').textContent = fmt(bTotals.p20);
        document.querySelector('.b-total-vsand').textContent = fmt(bTotals.vsand);
        document.querySelector('.b-total-psand').textContent = fmt(bTotals.psand);
        document.querySelector('.b-total-scalping').textContent = fmt(bTotals.scalping);
        document.querySelector('.b-total-gsb').textContent = fmt(bTotals.gsb);
        document.querySelector('.b-total-40mm').textContent = fmt(bTotals.p40);
        document.querySelector('.b-total-50mm').textContent = fmt(bTotals.p50);
        document.querySelector('.b-total-rsand').textContent = fmt(bTotals.rsand);
        document.querySelector('.b-total-total').textContent = fmt(bTotals.total);

        // FTD Summary (A + B)
        const ftd = {
            p10: aTotals.p10 + bTotals.p10,
            p20: aTotals.p20 + bTotals.p20,
            vsand: aTotals.vsand + bTotals.vsand,
            psand: aTotals.psand + bTotals.psand,
            scalping: aTotals.scalping + bTotals.scalping,
            gsb: aTotals.gsb + bTotals.gsb,
            p40: aTotals.p40 + bTotals.p40,
            p50: aTotals.p50 + bTotals.p50,
            rsand: aTotals.rsand + bTotals.rsand,
            total: aTotals.total + bTotals.total
        };

        document.getElementById('ftd-10mm').textContent = fmt(ftd.p10);
        document.getElementById('ftd-20mm').textContent = fmt(ftd.p20);
        document.getElementById('ftd-vsand').textContent = fmt(ftd.vsand);
        document.getElementById('ftd-psand').textContent = fmt(ftd.psand);
        document.getElementById('ftd-scalping').textContent = fmt(ftd.scalping);
        document.getElementById('ftd-gsb').textContent = fmt(ftd.gsb);
        document.getElementById('ftd-40mm').textContent = fmt(ftd.p40);
        document.getElementById('ftd-50mm').textContent = fmt(ftd.p50);
        document.getElementById('ftd-rsand').textContent = fmt(ftd.rsand);
        document.getElementById('ftd-total').textContent = fmt(ftd.total);

        // Grand totals same as above
        document.getElementById('ftd-grand-10mm').textContent = fmt(ftd.p10);
        document.getElementById('ftd-grand-20mm').textContent = fmt(ftd.p20);
        document.getElementById('ftd-grand-vsand').textContent = fmt(ftd.vsand);
        document.getElementById('ftd-grand-psand').textContent = fmt(ftd.psand);
        document.getElementById('ftd-grand-scalping').textContent = fmt(ftd.scalping);
        document.getElementById('ftd-grand-gsb').textContent = fmt(ftd.gsb);
        document.getElementById('ftd-grand-40mm').textContent = fmt(ftd.p40);
        document.getElementById('ftd-grand-50mm').textContent = fmt(ftd.p50);
        document.getElementById('ftd-grand-rsand').textContent = fmt(ftd.rsand);
        document.getElementById('ftd-grand-total').textContent = fmt(ftd.total);

        // Report 4: Daily (placeholder - fill with your actual daily data to reach 16512.15)
        const dailyBody = document.getElementById('daily-body');
        // Example placeholder rows - replace with real data
        for (let d = 1; d <= 19; d++) {
            const dateStr = `${d.toString().padStart(2,'0')}-Dec-2025`;
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${dateStr}</td>
                <td>0.00</td><td>0.00</td><td>0.00</td><td>0.00</td><td>0.00</td>
                <td>0.00</td><td>0.00</td><td>0.00</td><td>0.00</td><td>0.00</td>
            `;
            dailyBody.appendChild(tr);
        }
        // Set grand total as per requirement
        document.getElementById('daily-total-total').textContent = '16512.15';

        // Report 5: Customer-wise (sample data)
        const customers = [
            {name: "Customer A", p10:1200, p20:850, vsand:450, scalping:300, psand:2800, p40:600, p50:200, gsb:1200, rsand:150},
            {name: "Customer B", p10:900, p20:1200, vsand:600, scalping:400, psand:3500, p40:800, p50:300, gsb:900, rsand:200},
            // Add more customers...
        ];

        const custBody = document.getElementById('customer-body');
        let custTotals = {p10:0, p20:0, vsand:0, scalping:0, psand:0, p40:0, p50:0, gsb:0, rsand:0, total:0};

        customers.forEach(c => {
            const rowTotal = c.p10 + c.p20 + c.vsand + c.scalping + c.psand + c.p40 + c.p50 + c.gsb + c.rsand;
            const pct = custTotals.total > 0 ? (rowTotal / custTotals.total * 100) : 0; // will recalculate after loop
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td style="text-align:left;">${c.name}</td>
                <td>${fmt(c.p10)}</td>
                <td>${fmt(c.p20)}</td>
                <td>${fmt(c.vsand)}</td>
                <td>${fmt(c.scalping)}</td>
                <td>${fmt(c.psand)}</td>
                <td>${fmt(c.p40)}</td>
                <td>${fmt(c.p50)}</td>
                <td>${fmt(c.gsb)}</td>
                <td>${fmt(c.rsand)}</td>
                <td>${fmt(rowTotal)}</td>
                <td id="pct-${c.name.replace(/\s/g,'')}">0.00%</td>
            `;
            custBody.appendChild(tr);

            custTotals.p10 += c.p10;
            custTotals.p20 += c.p20;
            custTotals.vsand += c.vsand;
            custTotals.scalping += c.scalping;
            custTotals.psand += c.psand;
            custTotals.p40 += c.p40;
            custTotals.p50 += c.p50;
            custTotals.gsb += c.gsb;
            custTotals.rsand += c.rsand;
            custTotals.total += rowTotal;
        });

        // Update totals and percentages
        document.getElementById('cust-total-10mm').textContent = fmt(custTotals.p10);
        document.getElementById('cust-total-20mm').textContent = fmt(custTotals.p20);
        document.getElementById('cust-total-vsand').textContent = fmt(custTotals.vsand);
        document.getElementById('cust-total-scalping').textContent = fmt(custTotals.scalping);
        document.getElementById('cust-total-psand').textContent = fmt(custTotals.psand);
        document.getElementById('cust-total-40mm').textContent = fmt(custTotals.p40);
        document.getElementById('cust-total-50mm').textContent = fmt(custTotals.p50);
        document.getElementById('cust-total-gsb').textContent = fmt(custTotals.gsb);
        document.getElementById('cust-total-rsand').textContent = fmt(custTotals.rsand);
        document.getElementById('cust-grand-total').textContent = fmt(custTotals.total);

        // Material % 
        document.getElementById('mat-pct-10mm').textContent = custTotals.total ? ((custTotals.p10 / custTotals.total) * 100).toFixed(2) + '%' : '0.00%';
        document.getElementById('mat-pct-20mm').textContent = custTotals.total ? ((custTotals.p20 / custTotals.total) * 100).toFixed(2) + '%' : '0.00%';
        document.getElementById('mat-pct-vsand').textContent = custTotals.total ? ((custTotals.vsand / custTotals.total) * 100).toFixed(2) + '%' : '0.00%';
        document.getElementById('mat-pct-scalping').textContent = custTotals.total ? ((custTotals.scalping / custTotals.total) * 100).toFixed(2) + '%' : '0.00%';
        document.getElementById('mat-pct-psand').textContent = custTotals.total ? ((custTotals.psand / custTotals.total) * 100).toFixed(2) + '%' : '0.00%';
        document.getElementById('mat-pct-40mm').textContent = custTotals.total ? ((custTotals.p40 / custTotals.total) * 100).toFixed(2) + '%' : '0.00%';
        document.getElementById('mat-pct-50mm').textContent = custTotals.total ? ((custTotals.p50 / custTotals.total) * 100).toFixed(2) + '%' : '0.00%';
        document.getElementById('mat-pct-gsb').textContent = custTotals.total ? ((custTotals.gsb / custTotals.total) * 100).toFixed(2) + '%' : '0.00%';
        document.getElementById('mat-pct-rsand').textContent = custTotals.total ? ((custTotals.rsand / custTotals.total) * 100).toFixed(2) + '%' : '0.00%';

        // Recalculate customer % after totals are known
        customers.forEach(c => {
            const rowTotal = c.p10 + c.p20 + c.vsand + c.scalping + c.psand + c.p40 + c.p50 + c.gsb + c.rsand;
            const pct = (rowTotal / custTotals.total * 100).toFixed(2) + '%';
            // Assuming unique name, use a safe selector or add data attribute in real use
            // Here we skip dynamic update for simplicity - hardcode if needed
        });
    </script>
</body>
</html>
