<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quarry Dispatch Dashboard</title>
    <style>
        :root {
            --header-yellow: #fff2cc;
            --header-orange: #f8b88b;
            --header-green: #d5e8d4;
            --header-light-green: #e1f5e1;
            --total-light-green: #d9ead3;
            --total-dark-green: #c9daf8;
            --material-percent-bg: #fff2cc;
            --border-color: #d9d9d9;
            --shadow: 0 2px 8px rgba(0,0,0,0.1);
            --font-primary: 'Segoe UI', Roboto, Arial, sans-serif;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: var(--font-primary);
        }

        body {
            background-color: #f5f5f5;
            padding: 20px;
            color: #333;
            line-height: 1.5;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .section {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
        }

        .section-header {
            padding: 15px 20px;
            font-weight: bold;
            font-size: 1.2rem;
            margin: 0;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .section-header.yellow {
            background-color: var(--header-yellow);
            color: #cc0000;
        }

        .section-header.orange {
            background-color: var(--header-orange);
            color: #000;
            font-weight: bold;
        }

        .section-header.green {
            background-color: var(--header-green);
            color: #cc0000;
        }

        .section-header.light-green {
            background-color: var(--header-light-green);
            color: #cc0000;
        }

        .table-container {
            overflow-x: auto;
            position: relative;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1200px;
        }

        th {
            background-color: #f2f2f2;
            position: sticky;
            top: 56px;
            z-index: 9;
            font-weight: 600;
            border: 1px solid var(--border-color);
        }

        th, td {
            padding: 10px 12px;
            text-align: center;
            border: 1px solid var(--border-color);
            font-size: 0.9rem;
        }

        td.numeric {
            text-align: right;
            font-family: 'Segoe UI', 'Roboto Mono', monospace;
        }

        td.date {
            text-align: center;
            font-weight: 500;
        }

        .total-row {
            background-color: var(--total-light-green);
            font-weight: bold;
        }

        .grand-total-row {
            background-color: var(--total-dark-green);
            font-weight: bold;
        }

        .material-percent-row {
            background-color: var(--material-percent-bg);
            font-weight: bold;
        }

        .controls {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            padding: 20px 0;
            position: sticky;
            top: 0;
            background: #f5f5f5;
            z-index: 100;
            padding: 15px;
            margin: -15px -15px 15px -15px;
            border-bottom: 1px solid var(--border-color);
        }

        .nav-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }

        button {
            padding: 10px 20px;
            background-color: #4a6fa5;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.2s;
        }

        button:hover {
            background-color: #3a5a8a;
        }

        button.print-btn {
            background-color: #2e7d32;
        }

        button.print-btn:hover {
            background-color: #1b5e20;
        }

        .scroll-indicator {
            text-align: center;
            color: #666;
            font-size: 0.9rem;
            margin-top: 10px;
            font-style: italic;
        }

        .customer-name {
            text-align: left;
            font-weight: 500;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .controls, .nav-buttons, .scroll-indicator {
                display: none;
            }
            
            .section {
                box-shadow: none;
                border: 1px solid #000;
                break-inside: avoid;
            }
            
            .table-container {
                overflow: visible;
            }
            
            table {
                min-width: auto;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .section-header {
                padding: 12px 15px;
                font-size: 1.1rem;
            }
            
            th, td {
                padding: 8px 10px;
                font-size: 0.85rem;
            }
            
            .controls {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="controls">
        <h1 style="margin-right: auto; color: #2c3e50;">üè≠ Quarry Dispatch Dashboard</h1>
        <button onclick="printPage()" class="print-btn">üñ®Ô∏è Print Report</button>
        <button onclick="scrollToTop()">‚¨ÜÔ∏è Top</button>
    </div>

    <div class="container">
        <!-- Report 1: A-Shift Dispatched Details -->
        <div class="section" id="report1">
            <div class="section-header yellow">A-Shift Dispatched Details</div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>10 MM</th>
                            <th>20 MM</th>
                            <th>V/SAND</th>
                            <th>P/SAND</th>
                            <th>Scalping</th>
                            <th>GSB / Wet Mix</th>
                            <th>40 MM</th>
                            <th>50 MM</th>
                            <th>R/Sand</th>
                            <th>TOTAL</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="date">18-Dec-2025</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">22.22</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">22.22</td>
                        </tr>
                        <tr class="total-row">
                            <td class="customer-name">Total</td>
                            <td class="numeric" id="a-10mm">0.00</td>
                            <td class="numeric" id="a-20mm">0.00</td>
                            <td class="numeric" id="a-vsand">0.00</td>
                            <td class="numeric" id="a-psand">22.22</td>
                            <td class="numeric" id="a-scalping">0.00</td>
                            <td class="numeric" id="a-gsb">0.00</td>
                            <td class="numeric" id="a-40mm">0.00</td>
                            <td class="numeric" id="a-50mm">0.00</td>
                            <td class="numeric" id="a-rsand">0.00</td>
                            <td class="numeric" id="a-total">22.22</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Report 2: B-Shift Dispatched Details -->
        <div class="section" id="report2">
            <div class="section-header yellow">B-Shift Dispatched Details</div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>10 MM</th>
                            <th>20 MM</th>
                            <th>V/SAND</th>
                            <th>P/SAND</th>
                            <th>Scalping</th>
                            <th>GSB / Wet Mix</th>
                            <th>40 MM</th>
                            <th>50 MM</th>
                            <th>R/Sand</th>
                            <th>TOTAL</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="date">18-Dec-2025</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">70.58</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">70.58</td>
                        </tr>
                        <tr class="total-row">
                            <td class="customer-name">Total</td>
                            <td class="numeric" id="b-10mm">0.00</td>
                            <td class="numeric" id="b-20mm">0.00</td>
                            <td class="numeric" id="b-vsand">0.00</td>
                            <td class="numeric" id="b-psand">70.58</td>
                            <td class="numeric" id="b-scalping">0.00</td>
                            <td class="numeric" id="b-gsb">0.00</td>
                            <td class="numeric" id="b-40mm">0.00</td>
                            <td class="numeric" id="b-50mm">0.00</td>
                            <td class="numeric" id="b-rsand">0.00</td>
                            <td class="numeric" id="b-total">70.58</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Report 3: FTD Dispatch Summary -->
        <div class="section" id="report3">
            <div class="section-header orange">FTD Dispatched Summary (A Shift + B Shift)</div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Shift</th>
                            <th>10 MM</th>
                            <th>20 MM</th>
                            <th>V/SAND</th>
                            <th>P/SAND</th>
                            <th>Scalping</th>
                            <th>GSB / Wet Mix</th>
                            <th>40 MM</th>
                            <th>50 MM</th>
                            <th>R/Sand</th>
                            <th>TOTAL</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="customer-name">A Shift</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">22.22</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">22.22</td>
                        </tr>
                        <tr>
                            <td class="customer-name">B Shift</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">70.58</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">0.00</td>
                            <td class="numeric">70.58</td>
                        </tr>
                        <tr class="grand-total-row">
                            <td class="customer-name">FTD Total</td>
                            <td class="numeric" id="ftd-10mm">0.00</td>
                            <td class="numeric" id="ftd-20mm">0.00</td>
                            <td class="numeric" id="ftd-vsand">0.00</td>
                            <td class="numeric" id="ftd-psand">92.80</td>
                            <td class="numeric" id="ftd-scalping">0.00</td>
                            <td class="numeric" id="ftd-gsb">0.00</td>
                            <td class="numeric" id="ftd-40mm">0.00</td>
                            <td class="numeric" id="ftd-50mm">0.00</td>
                            <td class="numeric" id="ftd-rsand">0.00</td>
                            <td class="numeric" id="ftd-total">92.80</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Report 4: Daily Dispatched Details -->
        <div class="section" id="report4">
            <div class="section-header green">Dispatched Details (Date-wise: 01-12-2025 to 18-12-2025)</div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>10 MM</th>
                            <th>20 MM</th>
                            <th>V/SAND</th>
                            <th>Scalping</th>
                            <th>P/Sand</th>
                            <th>40 MM</th>
                            <th>50 MM</th>
                            <th>GSB/WET MIX</th>
                            <th>R/Sand</th>
                            <th>TOTAL</th>
                        </tr>
                    </thead>
                    <tbody id="daily-data">
                        <!-- Data will be populated by JavaScript -->
                    </tbody>
                    <tfoot>
                        <tr class="grand-total-row">
                            <td class="customer-name">Total</td>
                            <td class="numeric" id="daily-10mm">0.00</td>
                            <td class="numeric" id="daily-20mm">0.00</td>
                            <td class="numeric" id="daily-vsand">0.00</td>
                            <td class="numeric" id="daily-scalping">0.00</td>
                            <td class="numeric" id="daily-psand">0.00</td>
                            <td class="numeric" id="daily-40mm">0.00</td>
                            <td class="numeric" id="daily-50mm">0.00</td>
                            <td class="numeric" id="daily-gsb">0.00</td>
                            <td class="numeric" id="daily-rsand">0.00</td>
                            <td class="numeric" id="daily-total">16512.15</td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>

        <!-- Report 5: Customer-wise Cumulative Dispatch -->
        <div class="section" id="report5">
            <div class="section-header light-green">DECEMBER-2025 ‚Äì Customer Wise Cumulative Dispatched Details</div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Customer Name</th>
                            <th>10 MM</th>
                            <th>20 MM</th>
                            <th>V/SAND</th>
                            <th>Scalping</th>
                            <th>P/Sand</th>
                            <th>40 MM</th>
                            <th>50 MM</th>
                            <th>GSB/WET MIX</th>
                            <th>R/Sand</th>
                            <th>TOTAL</th>
                            <th>Customer-wise Dispatch Participation (%)</th>
                        </tr>
                    </thead>
                    <tbody id="customer-data">
                        <!-- Data will be populated by JavaScript -->
                    </tbody>
                    <tfoot>
                        <tr class="total-row">
                            <td class="customer-name">Total</td>
                            <td class="numeric" id="cust-10mm">0.00</td>
                            <td class="numeric" id="cust-20mm">0.00</td>
                            <td class="numeric" id="cust-vsand">0.00</td>
                            <td class="numeric" id="cust-scalping">0.00</td>
                            <td class="numeric" id="cust-psand">0.00</td>
                            <td class="numeric" id="cust-40mm">0.00</td>
                            <td class="numeric" id="cust-50mm">0.00</td>
                            <td class="numeric" id="cust-gsb">0.00</td>
                            <td class="numeric" id="cust-rsand">0.00</td>
                            <td class="numeric" id="cust-total">0.00</td>
                            <td class="numeric">100.00%</td>
                        </tr>
                        <tr class="material-percent-row">
                            <td class="customer-name">Material Wise (%) Participation</td>
                            <td class="numeric" id="mat-10mm">0.00%</td>
                            <td class="numeric" id="mat-20mm">0.00%</td>
                            <td class="numeric" id="mat-vsand">0.00%</td>
                            <td class="numeric" id="mat-scalping">0.00%</td>
                            <td class="numeric" id="mat-psand">0.00%</td>
                            <td class="numeric" id="mat-40mm">0.00%</td>
                            <td class="numeric" id="mat-50mm">0.00%</td>
                            <td class="numeric" id="mat-gsb">0.00%</td>
                            <td class="numeric" id="mat-rsand">0.00%</td>
                            <td class="numeric" id="mat-total">0.00%</td>
                            <td class="numeric">-</td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </div>

    <div class="nav-buttons">
        <button onclick="scrollToReport(1)">Report 1: A-Shift</button>
        <button onclick="scrollToReport(2)">Report 2: B-Shift</button>
        <button onclick="scrollToReport(3)">Report 3: FTD Summary</button>
        <button onclick="scrollToReport(4)">Report 4: Daily Details</button>
        <button onclick="scrollToReport(5)">Report 5: Customer-wise</button>
    </div>

    <div class="scroll-indicator">Scroll horizontally to view full table on mobile devices</div>

    <script>
        // Initialize data and calculations
        document.addEventListener('DOMContentLoaded', function() {
            initializeDailyData();
            initializeCustomerData();
            calculateAllTotals();
            updateFTDSummary();
        });

        // Sample daily data for December 1-18, 2025
        function initializeDailyData() {
            const dailyData = [
                { date: '01-Dec-2025', mm10: 150.5, mm20: 200.3, vsand: 180.2, scalping: 120.8, psand: 300.1, mm40: 95.7, mm50: 0, gsb: 210.4, rsand: 85.6 },
                { date: '02-Dec-2025', mm10: 145.2, mm20: 195.8, vsand: 175.9, scalping: 118.7, psand: 295.3, mm40: 92.4, mm50: 0, gsb: 205.1, rsand: 82.9 },
                { date: '03-Dec-2025', mm10: 160.8, mm20: 210.5, vsand: 190.3, scalping: 125.6, psand: 315.7, mm40: 98.2, mm50: 0, gsb: 220.9, rsand: 90.2 },
                { date: '04-Dec-2025', mm10: 142.1, mm20: 188.9, vsand: 170.5, scalping: 115.4, psand: 285.6, mm40: 89.8, mm50: 0, gsb: 198.7, rsand: 80.3 },
                { date: '05-Dec-2025', mm10: 155.7, mm20: 205.2, vsand: 185.8, scalping: 122.9, psand: 308.4, mm40: 96.3, mm50: 0, gsb: 215.6, rsand: 87.5 },
                { date: '06-Dec-2025', mm10: 148.3, mm20: 198.6, vsand: 178.4, scalping: 119.8, psand: 298.9, mm40: 93.7, mm50: 0, gsb: 208.3, rsand: 84.1 },
                { date: '07-Dec-2025', mm10: 165.4, mm20: 220.7, vsand: 198.6, scalping: 130.2, psand: 328.5, mm40: 102.1, mm50: 0, gsb: 230.8, rsand: 95.3 },
                { date: '08-Dec-2025', mm10: 138.9, mm20: 182.4, vsand: 165.8, scalping: 112.3, psand: 275.2, mm40: 86.9, mm50: 0, gsb: 192.5, rsand: 78.2 },
                { date: '09-Dec-2025', mm10: 152.6, mm20: 202.1, vsand: 183.7, scalping: 121.5, psand: 305.8, mm40: 95.2, mm50: 0, gsb: 212.9, rsand: 86.4 },
                { date: '10-Dec-2025', mm10: 158.2, mm20: 208.8, vsand: 188.9, scalping: 124.7, psand: 312.4, mm40: 97.5, mm50: 0, gsb: 218.6, rsand: 88.9 },
                { date: '11-Dec-2025', mm10: 143.5, mm20: 191.3, vsand: 173.2, scalping: 117.1, psand: 290.7, mm40: 91.4, mm50: 0, gsb: 203.8, rsand: 81.7 },
                { date: '12-Dec-2025', mm10: 162.9, mm20: 215.6, vsand: 195.4, scalping: 128.3, psand: 322.8, mm40: 100.3, mm50: 0, gsb: 225.7, rsand: 92.6 },
                { date: '13-Dec-2025', mm10: 147.8, mm20: 197.2, vsand: 177.5, scalping: 119.2, psand: 297.6, mm40: 93.1, mm50: 0, gsb: 207.4, rsand: 83.8 },
                { date: '14-Dec-2025', mm10: 154.3, mm20: 203.9, vsand: 184.6, scalping: 122.1, psand: 306.9, mm40: 95.8, mm50: 0, gsb: 214.3, rsand: 87.1 },
                { date: '15-Dec-2025', mm10: 140.7, mm20: 186.5, vsand: 168.9, scalping: 114.6, psand: 282.3, mm40: 88.7, mm50: 0, gsb: 196.8, rsand: 79.5 },
                { date: '16-Dec-2025', mm10: 159.6, mm20: 210.3, vsand: 190.8, scalping: 126.5, psand: 318.7, mm40: 99.2, mm50: 0, gsb: 222.4, rsand: 91.2 },
                { date: '17-Dec-2025', mm10: 149.4, mm20: 199.7, vsand: 179.8, scalping: 120.4, psand: 301.5, mm40: 94.3, mm50: 0, gsb: 209.8, rsand: 85.3 },
                { date: '18-Dec-2025', mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 92.8, mm40: 0, mm50: 0, gsb: 0, rsand: 0 }
            ];

            const tbody = document.getElementById('daily-data');
            dailyData.forEach(day => {
                const total = day.mm10 + day.mm20 + day.vsand + day.scalping + day.psand + 
                             day.mm40 + day.mm50 + day.gsb + day.rsand;
                
                const row = `
                    <tr>
                        <td class="date">${day.date}</td>
                        <td class="numeric">${day.mm10.toFixed(2)}</td>
                        <td class="numeric">${day.mm20.toFixed(2)}</td>
                        <td class="numeric">${day.vsand.toFixed(2)}</td>
                        <td class="numeric">${day.scalping.toFixed(2)}</td>
                        <td class="numeric">${day.psand.toFixed(2)}</td>
                        <td class="numeric">${day.mm40.toFixed(2)}</td>
                        <td class="numeric">${day.mm50.toFixed(2)}</td>
                        <td class="numeric">${day.gsb.toFixed(2)}</td>
                        <td class="numeric">${day.rsand.toFixed(2)}</td>
                        <td class="numeric">${total.toFixed(2)}</td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        // Sample customer data
        function initializeCustomerData() {
            const customerData = [
                { name: 'Customer A', mm10: 450.2, mm20: 600.8, vsand: 540.6, scalping: 360.9, psand: 900.3, mm40: 285.9, mm50: 0, gsb: 630.7, rsand: 255.4 },
                { name: 'Customer B', mm10: 380.5, mm20: 510.2, vsand: 459.3, scalping: 306.7, psand: 765.8, mm40: 242.1, mm50: 0, gsb: 534.9, rsand: 216.8 },
                { name: 'Customer C', mm10: 510.7, mm20: 680.9, vsand: 612.8, scalping: 408.5, psand: 1021.2, mm40: 323.4, mm50: 0, gsb: 714.2, rsand: 289.3 },
                { name: 'Customer D', mm10: 295.3, mm20: 395.1, vsand: 355.6, scalping: 237.2, psand: 592.7, mm40: 187.5, mm50: 0, gsb: 414.8, rsand: 168.1 },
                { name: 'Customer E', mm10: 420.8, mm20: 562.4, vsand: 506.2, scalping: 337.6, psand: 843.9, mm40: 267.2, mm50: 0, gsb: 590.4, rsand: 239.2 }
            ];

            const tbody = document.getElementById('customer-data');
            customerData.forEach(cust => {
                const total = cust.mm10 + cust.mm20 + cust.vsand + cust.scalping + cust.psand + 
                             cust.mm40 + cust.mm50 + cust.gsb + cust.rsand;
                
                const row = `
                    <tr>
                        <td class="customer-name">${cust.name}</td>
                        <td class="numeric">${cust.mm10.toFixed(2)}</td>
                        <td class="numeric">${cust.mm20.toFixed(2)}</td>
                        <td class="numeric">${cust.vsand.toFixed(2)}</td>
                        <td class="numeric">${cust.scalping.toFixed(2)}</td>
                        <td class="numeric">${cust.psand.toFixed(2)}</td>
                        <td class="numeric">${cust.mm40.toFixed(2)}</td>
                        <td class="numeric">${cust.mm50.toFixed(2)}</td>
                        <td class="numeric">${cust.gsb.toFixed(2)}</td>
                        <td class="numeric">${cust.rsand.toFixed(2)}</td>
                        <td class="numeric">${total.toFixed(2)}</td>
                        <td class="numeric">${((total / 16512.15) * 100).toFixed(2)}%</td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        // Calculate all totals
        function calculateAllTotals() {
            // Daily totals
            const dailyRows = document.querySelectorAll('#daily-data tr');
            const dailyTotals = {
                mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 0,
                mm40: 0, mm50: 0, gsb: 0, rsand: 0, total: 0
            };

            dailyRows.forEach(row => {
                const cells = row.querySelectorAll('td.numeric');
                dailyTotals.mm10 += parseFloat(cells[0].textContent) || 0;
                dailyTotals.mm20 += parseFloat(cells[1].textContent) || 0;
                dailyTotals.vsand += parseFloat(cells[2].textContent) || 0;
                dailyTotals.scalping += parseFloat(cells[3].textContent) || 0;
                dailyTotals.psand += parseFloat(cells[4].textContent) || 0;
                dailyTotals.mm40 += parseFloat(cells[5].textContent) || 0;
                dailyTotals.mm50 += parseFloat(cells[6].textContent) || 0;
                dailyTotals.gsb += parseFloat(cells[7].textContent) || 0;
                dailyTotals.rsand += parseFloat(cells[8].textContent) || 0;
            });

            dailyTotals.total = dailyTotals.mm10 + dailyTotals.mm20 + dailyTotals.vsand + 
                               dailyTotals.scalping + dailyTotals.psand + dailyTotals.mm40 + 
                               dailyTotals.mm50 + dailyTotals.gsb + dailyTotals.rsand;

            // Update daily totals display
            document.getElementById('daily-10mm').textContent = dailyTotals.mm10.toFixed(2);
            document.getElementById('daily-20mm').textContent = dailyTotals.mm20.toFixed(2);
            document.getElementById('daily-vsand').textContent = dailyTotals.vsand.toFixed(2);
            document.getElementById('daily-scalping').textContent = dailyTotals.scalping.toFixed(2);
            document.getElementById('daily-psand').textContent = dailyTotals.psand.toFixed(2);
            document.getElementById('daily-40mm').textContent = dailyTotals.mm40.toFixed(2);
            document.getElementById('daily-50mm').textContent = dailyTotals.mm50.toFixed(2);
            document.getElementById('daily-gsb').textContent = dailyTotals.gsb.toFixed(2);
            document.getElementById('daily-rsand').textContent = dailyTotals.rsand.toFixed(2);
            document.getElementById('daily-total').textContent = dailyTotals.total.toFixed(2);

            // Customer totals
            const customerRows = document.querySelectorAll('#customer-data tr');
            const custTotals = {
                mm10: 0, mm20: 0, vsand: 0, scalping: 0, psand: 0,
                mm40: 0, mm50: 0, gsb: 0, rsand: 0, total: 0
            };

            customerRows.forEach(row => {
                const cells = row.querySelectorAll('td.numeric');
                for(let i = 0; i < 9; i++) {
                    const value = parseFloat(cells[i].textContent) || 0;
                    switch(i) {
                        case 0: custTotals.mm10 += value; break;
                        case 1: custTotals.mm20 += value; break;
                        case 2: custTotals.vsand += value; break;
                        case 3: custTotals.scalping += value; break;
                        case 4: custTotals.psand += value; break;
                        case 5: custTotals.mm40 += value; break;
                        case 6: custTotals.mm50 += value; break;
                        case 7: custTotals.gsb += value; break;
                        case 8: custTotals.rsand += value; break;
                    }
                }
            });

            custTotals.total = custTotals.mm10 + custTotals.mm20 + custTotals.vsand + 
                              custTotals.scalping + custTotals.psand + custTotals.mm40 + 
                              custTotals.mm50 + custTotals.gsb + custTotals.rsand;

            // Update customer totals
            document.getElementById('cust-10mm').textContent = custTotals.mm10.toFixed(2);
            document.getElementById('cust-20mm').textContent = custTotals.mm20.toFixed(2);
            document.getElementById('cust-vsand').textContent = custTotals.vsand.toFixed(2);
            document.getElementById('cust-scalping').textContent = custTotals.scalping.toFixed(2);
            document.getElementById('cust-psand').textContent = custTotals.psand.toFixed(2);
            document.getElementById('cust-40mm').textContent = custTotals.mm40.toFixed(2);
            document.getElementById('cust-50mm').textContent = custTotals.mm50.toFixed(2);
            document.getElementById('cust-gsb').textContent = custTotals.gsb.toFixed(2);
            document.getElementById('cust-rsand').textContent = custTotals.rsand.toFixed(2);
            document.getElementById('cust-total').textContent = custTotals.total.toFixed(2);

            // Update material-wise percentages
            const grandTotal = custTotals.total || 1; // Avoid division by zero
            document.getElementById('mat-10mm').textContent = ((custTotals.mm10 / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-20mm').textContent = ((custTotals.mm20 / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-vsand').textContent = ((custTotals.vsand / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-scalping').textContent = ((custTotals.scalping / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-psand').textContent = ((custTotals.psand / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-40mm').textContent = ((custTotals.mm40 / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-50mm').textContent = ((custTotals.mm50 / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-gsb').textContent = ((custTotals.gsb / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-rsand').textContent = ((custTotals.rsand / grandTotal) * 100).toFixed(2) + '%';
            document.getElementById('mat-total').textContent = '100.00%';
        }

        // Update FTD Summary
        function updateFTDSummary() {
            const aShift = {
                mm10: 0, mm20: 0, vsand: 0, psand: 22.22, scalping: 0,
                gsb: 0, mm40: 0, mm50: 0, rsand: 0, total: 22.22
            };
            
            const bShift = {
                mm10: 0, mm20: 0, vsand: 0, psand: 70.58, scalping: 0,
                gsb: 0, mm40: 0, mm50: 0, rsand: 0, total: 70.58
            };

            // Calculate FTD totals
            document.getElementById('ftd-10mm').textContent = (aShift.mm10 + bShift.mm10).toFixed(2);
            document.getElementById('ftd-20mm').textContent = (aShift.mm20 + bShift.mm20).toFixed(2);
            document.getElementById('ftd-vsand').textContent = (aShift.vsand + bShift.vsand).toFixed(2);
            document.getElementById('ftd-psand').textContent = (aShift.psand + bShift.psand).toFixed(2);
            document.getElementById('ftd-scalping').textContent = (aShift.scalping + bShift.scalping).toFixed(2);
            document.getElementById('ftd-gsb').textContent = (aShift.gsb + bShift.gsb).toFixed(2);
            document.getElementById('ftd-40mm').textContent = (aShift.mm40 + bShift.mm40).toFixed(2);
            document.getElementById('ftd-50mm').textContent = (aShift.mm50 + bShift.mm50).toFixed(2);
            document.getElementById('ftd-rsand').textContent = (aShift.rsand + bShift.rsand).toFixed(2);
            document.getElementById('ftd-total').textContent = (aShift.total + bShift.total).toFixed(2);
        }

        // Navigation functions
        function scrollToReport(reportNumber) {
            const report = document.getElementById(`report${reportNumber}`);
            if (report) {
                report.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function printPage() {
            window.print();
        }
    </script>
</body>
</html>
